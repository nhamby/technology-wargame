import{s as En,n as pl,o as jn,f as Cn,r as Pn,d as vs}from"../chunks/HYagArB5.js";import{S as Rn,i as In,d as r,s as L,b as B,c as e,o as Ae,p as c,q as Mn,h as m,e as o,f as h,g as T,r as H,l as g,j as i,k as q,v as Gt,u as ds,y as kn,x as kl,w as fs,n as J,z as Sl,m as Vt,A as xa}from"../chunks/DFvcoiM4.js";import{s as Hl,v as Sn,r as $a,e as et}from"../chunks/Dfifp6px.js";import{g as en}from"../chunks/d6WERGuC.js";import{a as hs,G as at}from"../chunks/DwIE5O_Y.js";const Ln=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,{document:Ea}=Ln;function tn(l,t,s){var f,C,j;const a=l.slice();a[39]=t[s];const u=a[1].teams[a[39]];a[40]=u;const v=a[39]===a[0]||((f=a[2].spy_revealed[a[39]])==null?void 0:f.L);a[41]=v;const _=a[39]===a[0]||((C=a[2].spy_revealed[a[39]])==null?void 0:C.M);a[42]=_;const d=a[39]===a[0]||((j=a[2].spy_revealed[a[39]])==null?void 0:j.H);return a[43]=d,a}function ln(l,t,s){const a=l.slice();return a[46]=t[s],a}function sn(l,t,s){const a=l.slice();return a[46]=t[s],a}function an(l,t,s){const a=l.slice();return a[46]=t[s],a}function nn(l,t,s){const a=l.slice();return a[39]=t[s],a}function on(l,t,s){const a=l.slice();return a[39]=t[s],a}function Dn(l){let t,s,a,u,v,_="Round:",d,f=l[1].round+"",C,j,E=at.max_rounds+"",A,V,D,I,M="Budget (W):",w,N=l[2].W+"",G,U,Q,le="Dice:",ie,$=2*l[2].W+"",qe,ee,Z,Oe="Immigration:",We,F=l[2].IM===1?"Open":"Closed",O,ye,x,se,Ue="Talent (K):",ze,He=l[2].K.toFixed(1)+"",he,tt,Ye,kt="Knowledge (TK):",R,y=l[2].TK+"",K,_e,W,ae,lt="Score (TP) L/M/H:",Qe,ne=l[2].TP.L+"",Ee,k,te=l[2].TP.M+"",z,Y,X=l[2].TP.H+"",be,S,P,ce,ml,St=l[11].budget+"",Ft,gl,Lt=l[11].used+"",Wt,Tl,Dt,At=l[11].remaining+"",yt,Ut,ht,Be,nt,_s,Ll=l[1].round+"",Bl,bs,Xe,pe,zt,ja="Education (SE/TE)",ps,Yt,Ca="Two ways to build K (talent)",ms,Jt,ot,Nl,gs,Ts,Qt,it,wl,qs,Es,Ot,Pa="Immigration Policy",js,ct,Xt,je,Kl,Cs,Ps,Zt,Ce,Vl,Rs,Is,xt,Pe,Gl,Ms,ks,rt,$t,Ra="Basic Research (BR - Public)",Ss,el,Ia="BR builds TK but is shared with others",Ls,tl,Ds,Ne,Fl,Wl,As,we,ll,Ma="Applied Research (AR - Secret)",Os,sl,ka="Probabilistic discovery. Value scales with K",Hs,al,Bs,Je,yl,Ns,ut,ws,Re,Ul,Ks,Vs,vt,Gs,Ie,zl,Fs,Ws,me,nl,Sa="Espionage Effort (SP)",ys,ol,La="Max two targets per round",Us,il,zs,Ke,_t,Da="—",Yl,Ys,cl,Js,Ve,bt,Aa="L",pt,Oa="M",mt,Ha="H",Jl,Qs,Ht,Xs,Ge,gt,Ba="—",Ql,Zs,rl,xs,Fe,Tt,Na="L",qt,wa="M",Et,Ka="H",Xl,$s,jt,Dl=l[2].submitted?"Already Submitted":"Submit Allocations",Zl,xl,$l,dt,ul,Va="Your Dice Rolls This Round",ea,es,Ct,vl,Ga="Your Private AR & SP Log",ta,dl,ts,Pt,fl,Fa="Public Event Log (BR & Caught Spies)",la,Rt,ls,It,hl,Wa="Public Status Overview",sa,ql,Bt,El,ya='<tr><th class="svelte-1l6qcjv">Team</th> <th class="svelte-1l6qcjv">GDP</th> <th class="svelte-1l6qcjv">W</th> <th class="svelte-1l6qcjv">POP</th> <th class="svelte-1l6qcjv">SE</th> <th class="svelte-1l6qcjv">TE</th> <th class="svelte-1l6qcjv">IM</th> <th class="svelte-1l6qcjv">K</th> <th class="svelte-1l6qcjv">TK</th> <th class="svelte-1l6qcjv">BR (Own)</th> <th class="svelte-1l6qcjv">BR (Global)</th> <th class="svelte-1l6qcjv">TP(L)</th> <th class="svelte-1l6qcjv">TP(M)</th> <th class="svelte-1l6qcjv">TP(H)</th></tr>',aa,_l,na,oa,Ua,ge=l[4]&&cn(l),Me=l[2].submitted&&rn(),ke=l[11].remaining<0&&un(),Se=!l[15]&&vn(),Le=!l[14]&&dn(),jl=et(l[16]),re=[];for(let n=0;n<jl.length;n+=1)re[n]=fn(on(l,jl,n));let Cl=et(l[16]),ue=[];for(let n=0;n<Cl.length;n+=1)ue[n]=hn(nn(l,Cl,n));function za(n,b){return n[2].dice_log&&n[2].dice_log.length>0?Bn:Hn}let ss=za(l),st=ss(l),Te=l[0]&&bn(l),Mt=et(l[1].public_log.slice().reverse().slice(0,20)),ve=[];for(let n=0;n<Mt.length;n+=1)ve[n]=Tn(ln(l,Mt,n));let de=null;Mt.length||(de=gn());let Pl=et(hs),fe=[];for(let n=0;n<Pl.length;n+=1)fe[n]=qn(tn(l,Pl,n));return na=kn(l[22][0]),{c(){ge&&ge.c(),t=g(),s=i("div"),a=i("div"),u=i("div"),v=i("strong"),v.textContent=_,d=g(),C=q(f),j=q("/"),A=q(E),V=g(),D=i("div"),I=i("strong"),I.textContent=M,w=g(),G=q(N),U=q(" | "),Q=i("strong"),Q.textContent=le,ie=g(),qe=q($),ee=q(" | "),Z=i("strong"),Z.textContent=Oe,We=g(),O=q(F),ye=g(),x=i("div"),se=i("strong"),se.textContent=Ue,ze=g(),he=q(He),tt=q(" | "),Ye=i("strong"),Ye.textContent=kt,R=g(),K=q(y),_e=g(),W=i("div"),ae=i("strong"),ae.textContent=lt,Qe=g(),Ee=q(ne),k=q("/"),z=q(te),Y=q("/"),be=q(X),S=g(),Me&&Me.c(),P=g(),ce=i("div"),ml=q("Dice: "),Ft=q(St),gl=q("  |  Spent: "),Wt=q(Lt),Tl=q("  |  Remaining: "),Dt=i("strong"),yt=q(At),Ut=g(),ke&&ke.c(),ht=g(),Be=i("div"),nt=i("h2"),_s=q("Submit Allocations for Round "),Bl=q(Ll),bs=g(),Xe=i("div"),pe=i("div"),zt=i("h3"),zt.textContent=ja,ps=g(),Yt=i("p"),Yt.textContent=Ca,ms=g(),Jt=i("label"),ot=i("input"),gs=q(`
						Secondary Education (+1 K)`),Ts=g(),Qt=i("label"),it=i("input"),qs=q(`
						Tertiary Education (+1 K × (1+IM))`),Es=g(),Ot=i("h4"),Ot.textContent=Pa,js=g(),ct=i("div"),Xt=i("label"),je=i("input"),Cs=q(`
							No change`),Ps=g(),Zt=i("label"),Ce=i("input"),Rs=q(`
							Open (→1)`),Is=g(),xt=i("label"),Pe=i("input"),Ms=q(`
							Closed (→0)`),ks=g(),rt=i("div"),$t=i("h3"),$t.textContent=Ra,Ss=g(),el=i("p"),el.textContent=Ia,Ls=g(),tl=i("label"),Ds=q(`BR investment:
						`),Ne=i("input"),As=g(),we=i("div"),ll=i("h3"),ll.textContent=Ma,Os=g(),sl=i("p"),sl.textContent=ka,Hs=g(),al=i("label"),Bs=q(`AR (Incremental):
						`),Je=i("input"),Ns=g(),ut=i("label"),ws=q(`AR (Advanced):
						`),Re=i("input"),Ks=g(),Se&&Se.c(),Vs=g(),vt=i("label"),Gs=q(`AR (Radical):
						`),Ie=i("input"),Fs=g(),Le&&Le.c(),Ws=g(),me=i("div"),nl=i("h3"),nl.textContent=Sa,ys=g(),ol=i("p"),ol.textContent=La,Us=g(),il=i("label"),zs=q(`Target #1:
						`),Ke=i("select"),_t=i("option"),_t.textContent=Da;for(let n=0;n<re.length;n+=1)re[n].c();Ys=g(),cl=i("label"),Js=q(`Tech area #1:
						`),Ve=i("select"),bt=i("option"),bt.textContent=Aa,pt=i("option"),pt.textContent=Oa,mt=i("option"),mt.textContent=Ha,Qs=g(),Ht=i("label"),Xs=q(`Target #2:
						`),Ge=i("select"),gt=i("option"),gt.textContent=Ba;for(let n=0;n<ue.length;n+=1)ue[n].c();Zs=g(),rl=i("label"),xs=q(`Tech area #2:
						`),Fe=i("select"),Tt=i("option"),Tt.textContent=Na,qt=i("option"),qt.textContent=wa,Et=i("option"),Et.textContent=Ka,$s=g(),jt=i("button"),Zl=q(Dl),$l=g(),dt=i("div"),ul=i("h3"),ul.textContent=Va,ea=g(),st.c(),es=g(),Ct=i("div"),vl=i("h3"),vl.textContent=Ga,ta=g(),dl=i("div"),Te&&Te.c(),ts=g(),Pt=i("div"),fl=i("h3"),fl.textContent=Fa,la=g(),Rt=i("div");for(let n=0;n<ve.length;n+=1)ve[n].c();de&&de.c(),ls=g(),It=i("div"),hl=i("h3"),hl.textContent=Wa,sa=g(),ql=i("div"),Bt=i("table"),El=i("thead"),El.innerHTML=ya,aa=g(),_l=i("tbody");for(let n=0;n<fe.length;n+=1)fe[n].c();this.h()},l(n){ge&&ge.l(n),t=m(n),s=o(n,"DIV",{class:!0});var b=h(s);a=o(b,"DIV",{class:!0});var p=h(a);u=o(p,"DIV",{});var oe=h(u);v=o(oe,"STRONG",{"data-svelte-h":!0}),H(v)!=="svelte-hsut1y"&&(v.textContent=_),d=m(oe),C=T(oe,f),j=T(oe,"/"),A=T(oe,E),oe.forEach(r),V=m(p),D=o(p,"DIV",{});var Ze=h(D);I=o(Ze,"STRONG",{"data-svelte-h":!0}),H(I)!=="svelte-10olesh"&&(I.textContent=M),w=m(Ze),G=T(Ze,N),U=T(Ze," | "),Q=o(Ze,"STRONG",{"data-svelte-h":!0}),H(Q)!=="svelte-x1eqzz"&&(Q.textContent=le),ie=m(Ze),qe=T(Ze,$),ee=T(Ze," | "),Z=o(Ze,"STRONG",{"data-svelte-h":!0}),H(Z)!=="svelte-1wsrs"&&(Z.textContent=Oe),We=m(Ze),O=T(Ze,F),Ze.forEach(r),ye=m(p),x=o(p,"DIV",{});var Nt=h(x);se=o(Nt,"STRONG",{"data-svelte-h":!0}),H(se)!=="svelte-1syc6a"&&(se.textContent=Ue),ze=m(Nt),he=T(Nt,He),tt=T(Nt," | "),Ye=o(Nt,"STRONG",{"data-svelte-h":!0}),H(Ye)!=="svelte-19jpb6w"&&(Ye.textContent=kt),R=m(Nt),K=T(Nt,y),Nt.forEach(r),_e=m(p),W=o(p,"DIV",{});var wt=h(W);ae=o(wt,"STRONG",{"data-svelte-h":!0}),H(ae)!=="svelte-1kuszm"&&(ae.textContent=lt),Qe=m(wt),Ee=T(wt,ne),k=T(wt,"/"),z=T(wt,te),Y=T(wt,"/"),be=T(wt,X),wt.forEach(r),p.forEach(r),S=m(b),Me&&Me.l(b),b.forEach(r),P=m(n),ce=o(n,"DIV",{class:!0,style:!0});var bl=h(ce);ml=T(bl,"Dice: "),Ft=T(bl,St),gl=T(bl,"  |  Spent: "),Wt=T(bl,Lt),Tl=T(bl,"  |  Remaining: "),Dt=o(bl,"STRONG",{});var Ya=h(Dt);yt=T(Ya,At),Ya.forEach(r),bl.forEach(r),Ut=m(n),ke&&ke.l(n),ht=m(n),Be=o(n,"DIV",{class:!0});var Rl=h(Be);nt=o(Rl,"H2",{class:!0});var ia=h(nt);_s=T(ia,"Submit Allocations for Round "),Bl=T(ia,Ll),ia.forEach(r),bs=m(Rl),Xe=o(Rl,"DIV",{class:!0});var Kt=h(Xe);pe=o(Kt,"DIV",{class:!0});var xe=h(pe);zt=o(xe,"H3",{class:!0,"data-svelte-h":!0}),H(zt)!=="svelte-1908maf"&&(zt.textContent=ja),ps=m(xe),Yt=o(xe,"P",{class:!0,"data-svelte-h":!0}),H(Yt)!=="svelte-r0fkkv"&&(Yt.textContent=Ca),ms=m(xe),Jt=o(xe,"LABEL",{class:!0});var ca=h(Jt);ot=o(ca,"INPUT",{type:!0,class:!0}),gs=T(ca,`
						Secondary Education (+1 K)`),ca.forEach(r),Ts=m(xe),Qt=o(xe,"LABEL",{class:!0});var ra=h(Qt);it=o(ra,"INPUT",{type:!0,class:!0}),qs=T(ra,`
						Tertiary Education (+1 K × (1+IM))`),ra.forEach(r),Es=m(xe),Ot=o(xe,"H4",{style:!0,class:!0,"data-svelte-h":!0}),H(Ot)!=="svelte-15d845r"&&(Ot.textContent=Pa),js=m(xe),ct=o(xe,"DIV",{class:!0});var Il=h(ct);Xt=o(Il,"LABEL",{class:!0});var ua=h(Xt);je=o(ua,"INPUT",{type:!0}),Cs=T(ua,`
							No change`),ua.forEach(r),Ps=m(Il),Zt=o(Il,"LABEL",{class:!0});var va=h(Zt);Ce=o(va,"INPUT",{type:!0}),Rs=T(va,`
							Open (→1)`),va.forEach(r),Is=m(Il),xt=o(Il,"LABEL",{class:!0});var da=h(xt);Pe=o(da,"INPUT",{type:!0}),Ms=T(da,`
							Closed (→0)`),da.forEach(r),Il.forEach(r),xe.forEach(r),ks=m(Kt),rt=o(Kt,"DIV",{class:!0});var Ml=h(rt);$t=o(Ml,"H3",{class:!0,"data-svelte-h":!0}),H($t)!=="svelte-1wyo0t4"&&($t.textContent=Ra),Ss=m(Ml),el=o(Ml,"P",{class:!0,"data-svelte-h":!0}),H(el)!=="svelte-98payn"&&(el.textContent=Ia),Ls=m(Ml),tl=o(Ml,"LABEL",{class:!0});var fa=h(tl);Ds=T(fa,`BR investment:
						`),Ne=o(fa,"INPUT",{type:!0,min:!0,max:!0,class:!0}),fa.forEach(r),Ml.forEach(r),As=m(Kt),we=o(Kt,"DIV",{class:!0});var ft=h(we);ll=o(ft,"H3",{class:!0,"data-svelte-h":!0}),H(ll)!=="svelte-1dmhojt"&&(ll.textContent=Ma),Os=m(ft),sl=o(ft,"P",{class:!0,"data-svelte-h":!0}),H(sl)!=="svelte-1bpbcpi"&&(sl.textContent=ka),Hs=m(ft),al=o(ft,"LABEL",{class:!0});var ha=h(al);Bs=T(ha,`AR (Incremental):
						`),Je=o(ha,"INPUT",{type:!0,min:!0,max:!0,class:!0}),ha.forEach(r),Ns=m(ft),ut=o(ft,"LABEL",{class:!0});var Al=h(ut);ws=T(Al,`AR (Advanced):
						`),Re=o(Al,"INPUT",{type:!0,min:!0,max:!0,class:!0}),Ks=m(Al),Se&&Se.l(Al),Al.forEach(r),Vs=m(ft),vt=o(ft,"LABEL",{class:!0});var Ol=h(vt);Gs=T(Ol,`AR (Radical):
						`),Ie=o(Ol,"INPUT",{type:!0,min:!0,max:!0,class:!0}),Fs=m(Ol),Le&&Le.l(Ol),Ol.forEach(r),ft.forEach(r),Ws=m(Kt),me=o(Kt,"DIV",{class:!0});var $e=h(me);nl=o($e,"H3",{class:!0,"data-svelte-h":!0}),H(nl)!=="svelte-1a193wd"&&(nl.textContent=Sa),ys=m($e),ol=o($e,"P",{class:!0,"data-svelte-h":!0}),H(ol)!=="svelte-mwn5kr"&&(ol.textContent=La),Us=m($e),il=o($e,"LABEL",{class:!0});var _a=h(il);zs=T(_a,`Target #1:
						`),Ke=o(_a,"SELECT",{class:!0});var ba=h(Ke);_t=o(ba,"OPTION",{"data-svelte-h":!0}),H(_t)!=="svelte-anbbwg"&&(_t.textContent=Da);for(let De=0;De<re.length;De+=1)re[De].l(ba);ba.forEach(r),_a.forEach(r),Ys=m($e),cl=o($e,"LABEL",{class:!0});var pa=h(cl);Js=T(pa,`Tech area #1:
						`),Ve=o(pa,"SELECT",{class:!0});var as=h(Ve);bt=o(as,"OPTION",{"data-svelte-h":!0}),H(bt)!=="svelte-1o3elu6"&&(bt.textContent=Aa),pt=o(as,"OPTION",{"data-svelte-h":!0}),H(pt)!=="svelte-1virkf8"&&(pt.textContent=Oa),mt=o(as,"OPTION",{"data-svelte-h":!0}),H(mt)!=="svelte-10dzf2"&&(mt.textContent=Ha),as.forEach(r),pa.forEach(r),Qs=m($e),Ht=o($e,"LABEL",{style:!0,class:!0});var ma=h(Ht);Xs=T(ma,`Target #2:
						`),Ge=o(ma,"SELECT",{class:!0});var ga=h(Ge);gt=o(ga,"OPTION",{"data-svelte-h":!0}),H(gt)!=="svelte-anbbwg"&&(gt.textContent=Ba);for(let De=0;De<ue.length;De+=1)ue[De].l(ga);ga.forEach(r),ma.forEach(r),Zs=m($e),rl=o($e,"LABEL",{class:!0});var Ta=h(rl);xs=T(Ta,`Tech area #2:
						`),Fe=o(Ta,"SELECT",{class:!0});var ns=h(Fe);Tt=o(ns,"OPTION",{"data-svelte-h":!0}),H(Tt)!=="svelte-1o3elu6"&&(Tt.textContent=Na),qt=o(ns,"OPTION",{"data-svelte-h":!0}),H(qt)!=="svelte-1virkf8"&&(qt.textContent=wa),Et=o(ns,"OPTION",{"data-svelte-h":!0}),H(Et)!=="svelte-10dzf2"&&(Et.textContent=Ka),ns.forEach(r),Ta.forEach(r),$e.forEach(r),Kt.forEach(r),$s=m(Rl),jt=o(Rl,"BUTTON",{class:!0});var Ja=h(jt);Zl=T(Ja,Dl),Ja.forEach(r),Rl.forEach(r),$l=m(n),dt=o(n,"DIV",{class:!0});var os=h(dt);ul=o(os,"H3",{class:!0,"data-svelte-h":!0}),H(ul)!=="svelte-5eh94e"&&(ul.textContent=Va),ea=m(os),st.l(os),os.forEach(r),es=m(n),Ct=o(n,"DIV",{class:!0});var is=h(Ct);vl=o(is,"H3",{class:!0,"data-svelte-h":!0}),H(vl)!=="svelte-1upnx5y"&&(vl.textContent=Ga),ta=m(is),dl=o(is,"DIV",{class:!0});var Qa=h(dl);Te&&Te.l(Qa),Qa.forEach(r),is.forEach(r),ts=m(n),Pt=o(n,"DIV",{class:!0});var cs=h(Pt);fl=o(cs,"H3",{class:!0,"data-svelte-h":!0}),H(fl)!=="svelte-12dgy00"&&(fl.textContent=Fa),la=m(cs),Rt=o(cs,"DIV",{class:!0});var qa=h(Rt);for(let De=0;De<ve.length;De+=1)ve[De].l(qa);de&&de.l(qa),qa.forEach(r),cs.forEach(r),ls=m(n),It=o(n,"DIV",{class:!0});var rs=h(It);hl=o(rs,"H3",{class:!0,"data-svelte-h":!0}),H(hl)!=="svelte-185rolk"&&(hl.textContent=Wa),sa=m(rs),ql=o(rs,"DIV",{class:!0});var Xa=h(ql);Bt=o(Xa,"TABLE",{class:!0});var us=h(Bt);El=o(us,"THEAD",{"data-svelte-h":!0}),H(El)!=="svelte-1f270xy"&&(El.innerHTML=ya),aa=m(us),_l=o(us,"TBODY",{class:!0});var Za=h(_l);for(let De=0;De<fe.length;De+=1)fe[De].l(Za);Za.forEach(r),us.forEach(r),Xa.forEach(r),rs.forEach(r),this.h()},h(){c(a,"class","status-grid svelte-1l6qcjv"),c(s,"class","card status-header svelte-1l6qcjv"),c(ce,"class","budget-box svelte-1l6qcjv"),fs(ce,"background",l[12]),c(nt,"class","svelte-1l6qcjv"),c(zt,"class","svelte-1l6qcjv"),c(Yt,"class","help-text svelte-1l6qcjv"),c(ot,"type","checkbox"),ot.disabled=Nl=l[2].submitted,c(ot,"class","svelte-1l6qcjv"),c(Jt,"class","checkbox-label svelte-1l6qcjv"),c(it,"type","checkbox"),it.disabled=wl=l[2].submitted,c(it,"class","svelte-1l6qcjv"),c(Qt,"class","checkbox-label svelte-1l6qcjv"),fs(Ot,"margin-top","1.5rem"),c(Ot,"class","svelte-1l6qcjv"),c(je,"type","radio"),je.__value="none",J(je,je.__value),je.disabled=Kl=l[2].submitted,c(Xt,"class","svelte-1l6qcjv"),c(Ce,"type","radio"),Ce.__value="open",J(Ce,Ce.__value),Ce.disabled=Vl=l[2].submitted,c(Zt,"class","svelte-1l6qcjv"),c(Pe,"type","radio"),Pe.__value="close",J(Pe,Pe.__value),Pe.disabled=Gl=l[2].submitted,c(xt,"class","svelte-1l6qcjv"),c(ct,"class","radio-group svelte-1l6qcjv"),c(pe,"class","allocation-section svelte-1l6qcjv"),c($t,"class","svelte-1l6qcjv"),c(el,"class","help-text svelte-1l6qcjv"),c(Ne,"type","number"),c(Ne,"min","0"),c(Ne,"max",Fl=2*l[2].W),Ne.disabled=Wl=l[2].submitted,c(Ne,"class","number-input svelte-1l6qcjv"),c(tl,"class","svelte-1l6qcjv"),c(rt,"class","allocation-section svelte-1l6qcjv"),c(ll,"class","svelte-1l6qcjv"),c(sl,"class","help-text svelte-1l6qcjv"),c(Je,"type","number"),c(Je,"min","0"),c(Je,"max","3"),Je.disabled=yl=l[2].submitted||l[2].discovered.L,c(Je,"class","number-input svelte-1l6qcjv"),c(al,"class","svelte-1l6qcjv"),c(Re,"type","number"),c(Re,"min","0"),c(Re,"max","2"),Re.disabled=Ul=l[2].submitted||!l[15]||l[2].discovered.M,c(Re,"class","number-input svelte-1l6qcjv"),Sl(Re,"disabled",!l[15]),c(ut,"class","svelte-1l6qcjv"),c(Ie,"type","number"),c(Ie,"min","0"),c(Ie,"max","1"),Ie.disabled=zl=l[2].submitted||!l[14]||l[2].discovered.H,c(Ie,"class","number-input svelte-1l6qcjv"),Sl(Ie,"disabled",!l[14]),c(vt,"class","svelte-1l6qcjv"),c(we,"class","allocation-section svelte-1l6qcjv"),c(nl,"class","svelte-1l6qcjv"),c(ol,"class","help-text svelte-1l6qcjv"),_t.__value="",J(_t,_t.__value),Ke.disabled=Yl=l[2].submitted,c(Ke,"class","select-input svelte-1l6qcjv"),l[10][0].target===void 0&&vs(()=>l[29].call(Ke)),c(il,"class","svelte-1l6qcjv"),bt.__value="L",J(bt,bt.__value),pt.__value="M",J(pt,pt.__value),mt.__value="H",J(mt,mt.__value),Ve.disabled=Jl=l[2].submitted,c(Ve,"class","select-input svelte-1l6qcjv"),l[10][0].tech===void 0&&vs(()=>l[30].call(Ve)),c(cl,"class","svelte-1l6qcjv"),gt.__value="",J(gt,gt.__value),Ge.disabled=Ql=l[2].submitted,c(Ge,"class","select-input svelte-1l6qcjv"),l[10][1].target===void 0&&vs(()=>l[31].call(Ge)),fs(Ht,"margin-top","1rem"),c(Ht,"class","svelte-1l6qcjv"),Tt.__value="L",J(Tt,Tt.__value),qt.__value="M",J(qt,qt.__value),Et.__value="H",J(Et,Et.__value),Fe.disabled=Xl=l[2].submitted,c(Fe,"class","select-input svelte-1l6qcjv"),l[10][1].tech===void 0&&vs(()=>l[32].call(Fe)),c(rl,"class","svelte-1l6qcjv"),c(me,"class","allocation-section svelte-1l6qcjv"),c(Xe,"class","allocation-grid svelte-1l6qcjv"),c(jt,"class","btn btn-primary btn-large svelte-1l6qcjv"),jt.disabled=xl=!l[13]||l[2].submitted,c(Be,"class","card svelte-1l6qcjv"),c(ul,"class","svelte-1l6qcjv"),c(dt,"class","card svelte-1l6qcjv"),c(vl,"class","svelte-1l6qcjv"),c(dl,"class","log-container svelte-1l6qcjv"),c(Ct,"class","card svelte-1l6qcjv"),c(fl,"class","svelte-1l6qcjv"),c(Rt,"class","log-container svelte-1l6qcjv"),c(Pt,"class","card svelte-1l6qcjv"),c(hl,"class","svelte-1l6qcjv"),c(_l,"class","svelte-1l6qcjv"),c(Bt,"class","svelte-1l6qcjv"),c(ql,"class","table-scroll svelte-1l6qcjv"),c(It,"class","card svelte-1l6qcjv"),na.p(je,Ce,Pe)},m(n,b){ge&&ge.m(n,b),B(n,t,b),B(n,s,b),e(s,a),e(a,u),e(u,v),e(u,d),e(u,C),e(u,j),e(u,A),e(a,V),e(a,D),e(D,I),e(D,w),e(D,G),e(D,U),e(D,Q),e(D,ie),e(D,qe),e(D,ee),e(D,Z),e(D,We),e(D,O),e(a,ye),e(a,x),e(x,se),e(x,ze),e(x,he),e(x,tt),e(x,Ye),e(x,R),e(x,K),e(a,_e),e(a,W),e(W,ae),e(W,Qe),e(W,Ee),e(W,k),e(W,z),e(W,Y),e(W,be),e(s,S),Me&&Me.m(s,null),B(n,P,b),B(n,ce,b),e(ce,ml),e(ce,Ft),e(ce,gl),e(ce,Wt),e(ce,Tl),e(ce,Dt),e(Dt,yt),B(n,Ut,b),ke&&ke.m(n,b),B(n,ht,b),B(n,Be,b),e(Be,nt),e(nt,_s),e(nt,Bl),e(Be,bs),e(Be,Xe),e(Xe,pe),e(pe,zt),e(pe,ps),e(pe,Yt),e(pe,ms),e(pe,Jt),e(Jt,ot),ot.checked=l[5],e(Jt,gs),e(pe,Ts),e(pe,Qt),e(Qt,it),it.checked=l[6],e(Qt,qs),e(pe,Es),e(pe,Ot),e(pe,js),e(pe,ct),e(ct,Xt),e(Xt,je),je.checked=je.__value===l[7],e(Xt,Cs),e(ct,Ps),e(ct,Zt),e(Zt,Ce),Ce.checked=Ce.__value===l[7],e(Zt,Rs),e(ct,Is),e(ct,xt),e(xt,Pe),Pe.checked=Pe.__value===l[7],e(xt,Ms),e(Xe,ks),e(Xe,rt),e(rt,$t),e(rt,Ss),e(rt,el),e(rt,Ls),e(rt,tl),e(tl,Ds),e(tl,Ne),J(Ne,l[8]),e(Xe,As),e(Xe,we),e(we,ll),e(we,Os),e(we,sl),e(we,Hs),e(we,al),e(al,Bs),e(al,Je),J(Je,l[9].L),e(we,Ns),e(we,ut),e(ut,ws),e(ut,Re),J(Re,l[9].M),e(ut,Ks),Se&&Se.m(ut,null),e(we,Vs),e(we,vt),e(vt,Gs),e(vt,Ie),J(Ie,l[9].H),e(vt,Fs),Le&&Le.m(vt,null),e(Xe,Ws),e(Xe,me),e(me,nl),e(me,ys),e(me,ol),e(me,Us),e(me,il),e(il,zs),e(il,Ke),e(Ke,_t);for(let p=0;p<re.length;p+=1)re[p]&&re[p].m(Ke,null);Vt(Ke,l[10][0].target,!0),e(me,Ys),e(me,cl),e(cl,Js),e(cl,Ve),e(Ve,bt),e(Ve,pt),e(Ve,mt),Vt(Ve,l[10][0].tech,!0),e(me,Qs),e(me,Ht),e(Ht,Xs),e(Ht,Ge),e(Ge,gt);for(let p=0;p<ue.length;p+=1)ue[p]&&ue[p].m(Ge,null);Vt(Ge,l[10][1].target,!0),e(me,Zs),e(me,rl),e(rl,xs),e(rl,Fe),e(Fe,Tt),e(Fe,qt),e(Fe,Et),Vt(Fe,l[10][1].tech,!0),e(Be,$s),e(Be,jt),e(jt,Zl),B(n,$l,b),B(n,dt,b),e(dt,ul),e(dt,ea),st.m(dt,null),B(n,es,b),B(n,Ct,b),e(Ct,vl),e(Ct,ta),e(Ct,dl),Te&&Te.m(dl,null),B(n,ts,b),B(n,Pt,b),e(Pt,fl),e(Pt,la),e(Pt,Rt);for(let p=0;p<ve.length;p+=1)ve[p]&&ve[p].m(Rt,null);de&&de.m(Rt,null),B(n,ls,b),B(n,It,b),e(It,hl),e(It,sa),e(It,ql),e(ql,Bt),e(Bt,El),e(Bt,aa),e(Bt,_l);for(let p=0;p<fe.length;p+=1)fe[p]&&fe[p].m(_l,null);oa||(Ua=[Ae(ot,"change",l[19]),Ae(it,"change",l[20]),Ae(je,"change",l[21]),Ae(Ce,"change",l[23]),Ae(Pe,"change",l[24]),Ae(Ne,"input",l[25]),Ae(Je,"input",l[26]),Ae(Re,"input",l[27]),Ae(Ie,"input",l[28]),Ae(Ke,"change",l[29]),Ae(Ve,"change",l[30]),Ae(Ge,"change",l[31]),Ae(Fe,"change",l[32]),Ae(jt,"click",l[17])],oa=!0)},p(n,b){if(n[4]?ge?ge.p(n,b):(ge=cn(n),ge.c(),ge.m(t.parentNode,t)):ge&&(ge.d(1),ge=null),b[0]&2&&f!==(f=n[1].round+"")&&L(C,f),b[0]&4&&N!==(N=n[2].W+"")&&L(G,N),b[0]&4&&$!==($=2*n[2].W+"")&&L(qe,$),b[0]&4&&F!==(F=n[2].IM===1?"Open":"Closed")&&L(O,F),b[0]&4&&He!==(He=n[2].K.toFixed(1)+"")&&L(he,He),b[0]&4&&y!==(y=n[2].TK+"")&&L(K,y),b[0]&4&&ne!==(ne=n[2].TP.L+"")&&L(Ee,ne),b[0]&4&&te!==(te=n[2].TP.M+"")&&L(z,te),b[0]&4&&X!==(X=n[2].TP.H+"")&&L(be,X),n[2].submitted?Me||(Me=rn(),Me.c(),Me.m(s,null)):Me&&(Me.d(1),Me=null),b[0]&2048&&St!==(St=n[11].budget+"")&&L(Ft,St),b[0]&2048&&Lt!==(Lt=n[11].used+"")&&L(Wt,Lt),b[0]&2048&&At!==(At=n[11].remaining+"")&&L(yt,At),b[0]&4096&&fs(ce,"background",n[12]),n[11].remaining<0?ke||(ke=un(),ke.c(),ke.m(ht.parentNode,ht)):ke&&(ke.d(1),ke=null),b[0]&2&&Ll!==(Ll=n[1].round+"")&&L(Bl,Ll),b[0]&4&&Nl!==(Nl=n[2].submitted)&&(ot.disabled=Nl),b[0]&32&&(ot.checked=n[5]),b[0]&4&&wl!==(wl=n[2].submitted)&&(it.disabled=wl),b[0]&64&&(it.checked=n[6]),b[0]&4&&Kl!==(Kl=n[2].submitted)&&(je.disabled=Kl),b[0]&128&&(je.checked=je.__value===n[7]),b[0]&4&&Vl!==(Vl=n[2].submitted)&&(Ce.disabled=Vl),b[0]&128&&(Ce.checked=Ce.__value===n[7]),b[0]&4&&Gl!==(Gl=n[2].submitted)&&(Pe.disabled=Gl),b[0]&128&&(Pe.checked=Pe.__value===n[7]),b[0]&4&&Fl!==(Fl=2*n[2].W)&&c(Ne,"max",Fl),b[0]&4&&Wl!==(Wl=n[2].submitted)&&(Ne.disabled=Wl),b[0]&256&&Gt(Ne.value)!==n[8]&&J(Ne,n[8]),b[0]&4&&yl!==(yl=n[2].submitted||n[2].discovered.L)&&(Je.disabled=yl),b[0]&512&&Gt(Je.value)!==n[9].L&&J(Je,n[9].L),b[0]&32772&&Ul!==(Ul=n[2].submitted||!n[15]||n[2].discovered.M)&&(Re.disabled=Ul),b[0]&512&&Gt(Re.value)!==n[9].M&&J(Re,n[9].M),b[0]&32768&&Sl(Re,"disabled",!n[15]),n[15]?Se&&(Se.d(1),Se=null):Se||(Se=vn(),Se.c(),Se.m(ut,null)),b[0]&16388&&zl!==(zl=n[2].submitted||!n[14]||n[2].discovered.H)&&(Ie.disabled=zl),b[0]&512&&Gt(Ie.value)!==n[9].H&&J(Ie,n[9].H),b[0]&16384&&Sl(Ie,"disabled",!n[14]),n[14]?Le&&(Le.d(1),Le=null):Le||(Le=dn(),Le.c(),Le.m(vt,null)),b[0]&65536){jl=et(n[16]);let p;for(p=0;p<jl.length;p+=1){const oe=on(n,jl,p);re[p]?re[p].p(oe,b):(re[p]=fn(oe),re[p].c(),re[p].m(Ke,null))}for(;p<re.length;p+=1)re[p].d(1);re.length=jl.length}if(b[0]&4&&Yl!==(Yl=n[2].submitted)&&(Ke.disabled=Yl),b[0]&66560&&Vt(Ke,n[10][0].target),b[0]&4&&Jl!==(Jl=n[2].submitted)&&(Ve.disabled=Jl),b[0]&66560&&Vt(Ve,n[10][0].tech),b[0]&65536){Cl=et(n[16]);let p;for(p=0;p<Cl.length;p+=1){const oe=nn(n,Cl,p);ue[p]?ue[p].p(oe,b):(ue[p]=hn(oe),ue[p].c(),ue[p].m(Ge,null))}for(;p<ue.length;p+=1)ue[p].d(1);ue.length=Cl.length}if(b[0]&4&&Ql!==(Ql=n[2].submitted)&&(Ge.disabled=Ql),b[0]&66560&&Vt(Ge,n[10][1].target),b[0]&4&&Xl!==(Xl=n[2].submitted)&&(Fe.disabled=Xl),b[0]&66560&&Vt(Fe,n[10][1].tech),b[0]&4&&Dl!==(Dl=n[2].submitted?"Already Submitted":"Submit Allocations")&&L(Zl,Dl),b[0]&8196&&xl!==(xl=!n[13]||n[2].submitted)&&(jt.disabled=xl),ss===(ss=za(n))&&st?st.p(n,b):(st.d(1),st=ss(n),st&&(st.c(),st.m(dt,null))),n[0]?Te?Te.p(n,b):(Te=bn(n),Te.c(),Te.m(dl,null)):Te&&(Te.d(1),Te=null),b[0]&2){Mt=et(n[1].public_log.slice().reverse().slice(0,20));let p;for(p=0;p<Mt.length;p+=1){const oe=ln(n,Mt,p);ve[p]?ve[p].p(oe,b):(ve[p]=Tn(oe),ve[p].c(),ve[p].m(Rt,null))}for(;p<ve.length;p+=1)ve[p].d(1);ve.length=Mt.length,!Mt.length&&de?de.p(n,b):Mt.length?de&&(de.d(1),de=null):(de=gn(),de.c(),de.m(Rt,null))}if(b[0]&7){Pl=et(hs);let p;for(p=0;p<Pl.length;p+=1){const oe=tn(n,Pl,p);fe[p]?fe[p].p(oe,b):(fe[p]=qn(oe),fe[p].c(),fe[p].m(_l,null))}for(;p<fe.length;p+=1)fe[p].d(1);fe.length=Pl.length}},d(n){n&&(r(t),r(s),r(P),r(ce),r(Ut),r(ht),r(Be),r($l),r(dt),r(es),r(Ct),r(ts),r(Pt),r(ls),r(It)),ge&&ge.d(n),Me&&Me.d(),ke&&ke.d(n),Se&&Se.d(),Le&&Le.d(),kl(re,n),kl(ue,n),st.d(),Te&&Te.d(),kl(ve,n),de&&de.d(),kl(fe,n),na.r(),oa=!1,Pn(Ua)}}}function An(l){let t,s='<h2 style="color:red;" class="svelte-1l6qcjv">⏳ Waiting for GM to initialize the game...</h2> <p>The Game Master must initialize the game before you can play.</p>';return{c(){t=i("div"),t.innerHTML=s,this.h()},l(a){t=o(a,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-3jvgde"&&(t.innerHTML=s),this.h()},h(){c(t,"class","card svelte-1l6qcjv")},m(a,u){B(a,t,u)},p:pl,d(a){a&&r(t)}}}function On(l){let t,s="<p>Loading game state...</p>";return{c(){t=i("div"),t.innerHTML=s,this.h()},l(a){t=o(a,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-rgk6g2"&&(t.innerHTML=s),this.h()},h(){c(t,"class","card svelte-1l6qcjv")},m(a,u){B(a,t,u)},p:pl,d(a){a&&r(t)}}}function cn(l){let t,s,a;return{c(){t=i("div"),s=q(l[4]),this.h()},l(u){t=o(u,"DIV",{class:!0});var v=h(t);s=T(v,l[4]),v.forEach(r),this.h()},h(){c(t,"class",a="alert "+(l[4].includes("Error")||l[4].includes("Warning")?"alert-warning":"alert-success")+" svelte-1l6qcjv")},m(u,v){B(u,t,v),e(t,s)},p(u,v){v[0]&16&&L(s,u[4]),v[0]&16&&a!==(a="alert "+(u[4].includes("Error")||u[4].includes("Warning")?"alert-warning":"alert-success")+" svelte-1l6qcjv")&&c(t,"class",a)},d(u){u&&r(t)}}}function rn(l){let t,s="Submitted for this round - waiting for GM";return{c(){t=i("div"),t.textContent=s,this.h()},l(a){t=o(a,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-176y4ly"&&(t.textContent=s),this.h()},h(){c(t,"class","submitted-banner svelte-1l6qcjv")},m(a,u){B(a,t,u)},d(a){a&&r(t)}}}function un(l){let t,s="You are over budget! Please reduce allocations.";return{c(){t=i("div"),t.textContent=s,this.h()},l(a){t=o(a,"DIV",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-1e2pjt5"&&(t.textContent=s),this.h()},h(){c(t,"class","alert alert-warning svelte-1l6qcjv")},m(a,u){B(a,t,u)},d(a){a&&r(t)}}}function vn(l){let t,s,a=at.tech_info.M.br_req+"",u,v;return{c(){t=i("span"),s=q("Requires "),u=q(a),v=q(" BR"),this.h()},l(_){t=o(_,"SPAN",{class:!0});var d=h(t);s=T(d,"Requires "),u=T(d,a),v=T(d," BR"),d.forEach(r),this.h()},h(){c(t,"class","req-text svelte-1l6qcjv")},m(_,d){B(_,t,d),e(t,s),e(t,u),e(t,v)},d(_){_&&r(t)}}}function dn(l){let t,s,a=at.tech_info.H.br_req+"",u,v;return{c(){t=i("span"),s=q("Requires "),u=q(a),v=q(" BR"),this.h()},l(_){t=o(_,"SPAN",{class:!0});var d=h(t);s=T(d,"Requires "),u=T(d,a),v=T(d," BR"),d.forEach(r),this.h()},h(){c(t,"class","req-text svelte-1l6qcjv")},m(_,d){B(_,t,d),e(t,s),e(t,u),e(t,v)},d(_){_&&r(t)}}}function fn(l){let t,s=l[39]+"",a,u;return{c(){t=i("option"),a=q(s),this.h()},l(v){t=o(v,"OPTION",{});var _=h(t);a=T(_,s),_.forEach(r),this.h()},h(){t.__value=u=l[39],J(t,t.__value)},m(v,_){B(v,t,_),e(t,a)},p(v,_){_[0]&65536&&s!==(s=v[39]+"")&&L(a,s),_[0]&65536&&u!==(u=v[39])&&(t.__value=u,J(t,t.__value))},d(v){v&&r(t)}}}function hn(l){let t,s=l[39]+"",a,u;return{c(){t=i("option"),a=q(s),this.h()},l(v){t=o(v,"OPTION",{});var _=h(t);a=T(_,s),_.forEach(r),this.h()},h(){t.__value=u=l[39],J(t,t.__value)},m(v,_){B(v,t,_),e(t,a)},p(v,_){_[0]&65536&&s!==(s=v[39]+"")&&L(a,s),_[0]&65536&&u!==(u=v[39])&&(t.__value=u,J(t,t.__value))},d(v){v&&r(t)}}}function Hn(l){let t,s="No dice rolls yet for this round";return{c(){t=i("p"),t.textContent=s,this.h()},l(a){t=o(a,"P",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-1o9h2gv"&&(t.textContent=s),this.h()},h(){c(t,"class","muted svelte-1l6qcjv")},m(a,u){B(a,t,u)},p:pl,d(a){a&&r(t)}}}function Bn(l){let t,s,a,u='<tr><th class="svelte-1l6qcjv">Phase</th> <th class="svelte-1l6qcjv">Tech</th> <th class="svelte-1l6qcjv">Rolls</th> <th class="svelte-1l6qcjv">ΔTK</th> <th class="svelte-1l6qcjv">ΔTP</th> <th class="svelte-1l6qcjv">ΔIM</th> <th class="svelte-1l6qcjv">SP Result</th></tr>',v,_,d=et(l[2].dice_log),f=[];for(let C=0;C<d.length;C+=1)f[C]=_n(an(l,d,C));return{c(){t=i("div"),s=i("table"),a=i("thead"),a.innerHTML=u,v=g(),_=i("tbody");for(let C=0;C<f.length;C+=1)f[C].c();this.h()},l(C){t=o(C,"DIV",{class:!0});var j=h(t);s=o(j,"TABLE",{class:!0});var E=h(s);a=o(E,"THEAD",{"data-svelte-h":!0}),H(a)!=="svelte-bkqdk4"&&(a.innerHTML=u),v=m(E),_=o(E,"TBODY",{class:!0});var A=h(_);for(let V=0;V<f.length;V+=1)f[V].l(A);A.forEach(r),E.forEach(r),j.forEach(r),this.h()},h(){c(_,"class","svelte-1l6qcjv"),c(s,"class","svelte-1l6qcjv"),c(t,"class","table-scroll svelte-1l6qcjv")},m(C,j){B(C,t,j),e(t,s),e(s,a),e(s,v),e(s,_);for(let E=0;E<f.length;E+=1)f[E]&&f[E].m(_,null)},p(C,j){if(j[0]&4){d=et(C[2].dice_log);let E;for(E=0;E<d.length;E+=1){const A=an(C,d,E);f[E]?f[E].p(A,j):(f[E]=_n(A),f[E].c(),f[E].m(_,null))}for(;E<f.length;E+=1)f[E].d(1);f.length=d.length}},d(C){C&&r(t),kl(f,C)}}}function _n(l){let t,s,a=l[46].Phase+"",u,v,_,d=l[46].Tech+"",f,C,j,E=l[46].Rolls+"",A,V,D,I=l[46].ΔTK+"",M,w,N,G=l[46].ΔTP+"",U,Q,le,ie=l[46].ΔIM+"",$,qe,ee,Z=l[46].SP_Result+"",Oe,We;return{c(){t=i("tr"),s=i("td"),u=q(a),v=g(),_=i("td"),f=q(d),C=g(),j=i("td"),A=q(E),V=g(),D=i("td"),M=q(I),w=g(),N=i("td"),U=q(G),Q=g(),le=i("td"),$=q(ie),qe=g(),ee=i("td"),Oe=q(Z),We=g(),this.h()},l(F){t=o(F,"TR",{class:!0});var O=h(t);s=o(O,"TD",{class:!0});var ye=h(s);u=T(ye,a),ye.forEach(r),v=m(O),_=o(O,"TD",{class:!0});var x=h(_);f=T(x,d),x.forEach(r),C=m(O),j=o(O,"TD",{class:!0});var se=h(j);A=T(se,E),se.forEach(r),V=m(O),D=o(O,"TD",{class:!0});var Ue=h(D);M=T(Ue,I),Ue.forEach(r),w=m(O),N=o(O,"TD",{class:!0});var ze=h(N);U=T(ze,G),ze.forEach(r),Q=m(O),le=o(O,"TD",{class:!0});var He=h(le);$=T(He,ie),He.forEach(r),qe=m(O),ee=o(O,"TD",{class:!0});var he=h(ee);Oe=T(he,Z),he.forEach(r),We=m(O),O.forEach(r),this.h()},h(){c(s,"class","svelte-1l6qcjv"),c(_,"class","svelte-1l6qcjv"),c(j,"class","svelte-1l6qcjv"),c(D,"class","svelte-1l6qcjv"),c(N,"class","svelte-1l6qcjv"),c(le,"class","svelte-1l6qcjv"),c(ee,"class","svelte-1l6qcjv"),c(t,"class","svelte-1l6qcjv")},m(F,O){B(F,t,O),e(t,s),e(s,u),e(t,v),e(t,_),e(_,f),e(t,C),e(t,j),e(j,A),e(t,V),e(t,D),e(D,M),e(t,w),e(t,N),e(N,U),e(t,Q),e(t,le),e(le,$),e(t,qe),e(t,ee),e(ee,Oe),e(t,We)},p(F,O){O[0]&4&&a!==(a=F[46].Phase+"")&&L(u,a),O[0]&4&&d!==(d=F[46].Tech+"")&&L(f,d),O[0]&4&&E!==(E=F[46].Rolls+"")&&L(A,E),O[0]&4&&I!==(I=F[46].ΔTK+"")&&L(M,I),O[0]&4&&G!==(G=F[46].ΔTP+"")&&L(U,G),O[0]&4&&ie!==(ie=F[46].ΔIM+"")&&L($,ie),O[0]&4&&Z!==(Z=F[46].SP_Result+"")&&L(Oe,Z)},d(F){F&&r(t)}}}function bn(l){let t,s=et(l[1].private_logs[l[0]].slice().reverse()),a=[];for(let v=0;v<s.length;v+=1)a[v]=mn(sn(l,s,v));let u=null;return s.length||(u=pn()),{c(){for(let v=0;v<a.length;v+=1)a[v].c();t=xa(),u&&u.c()},l(v){for(let _=0;_<a.length;_+=1)a[_].l(v);t=xa(),u&&u.l(v)},m(v,_){for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(v,_);B(v,t,_),u&&u.m(v,_)},p(v,_){if(_[0]&3){s=et(v[1].private_logs[v[0]].slice().reverse());let d;for(d=0;d<s.length;d+=1){const f=sn(v,s,d);a[d]?a[d].p(f,_):(a[d]=mn(f),a[d].c(),a[d].m(t.parentNode,t))}for(;d<a.length;d+=1)a[d].d(1);a.length=s.length,!s.length&&u?u.p(v,_):s.length?u&&(u.d(1),u=null):(u=pn(),u.c(),u.m(t.parentNode,t))}},d(v){v&&r(t),kl(a,v),u&&u.d(v)}}}function pn(l){let t,s="No private events yet";return{c(){t=i("p"),t.textContent=s,this.h()},l(a){t=o(a,"P",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-x74teb"&&(t.textContent=s),this.h()},h(){c(t,"class","muted svelte-1l6qcjv")},m(a,u){B(a,t,u)},p:pl,d(a){a&&r(t)}}}function mn(l){let t,s,a,u=l[46].round+"",v,_,d=l[46].event+"",f,C;return{c(){t=i("div"),s=i("span"),a=q("R"),v=q(u),_=g(),f=q(d),C=g(),this.h()},l(j){t=o(j,"DIV",{class:!0});var E=h(t);s=o(E,"SPAN",{class:!0});var A=h(s);a=T(A,"R"),v=T(A,u),A.forEach(r),_=m(E),f=T(E,d),C=m(E),E.forEach(r),this.h()},h(){c(s,"class","log-round svelte-1l6qcjv"),c(t,"class","log-entry svelte-1l6qcjv")},m(j,E){B(j,t,E),e(t,s),e(s,a),e(s,v),e(t,_),e(t,f),e(t,C)},p(j,E){E[0]&3&&u!==(u=j[46].round+"")&&L(v,u),E[0]&3&&d!==(d=j[46].event+"")&&L(f,d)},d(j){j&&r(t)}}}function gn(l){let t,s="No public events yet";return{c(){t=i("p"),t.textContent=s,this.h()},l(a){t=o(a,"P",{class:!0,"data-svelte-h":!0}),H(t)!=="svelte-dj55rt"&&(t.textContent=s),this.h()},h(){c(t,"class","muted svelte-1l6qcjv")},m(a,u){B(a,t,u)},p:pl,d(a){a&&r(t)}}}function Tn(l){let t,s,a,u=l[46].round+"",v,_,d=l[46].event+"",f,C;return{c(){t=i("div"),s=i("span"),a=q("R"),v=q(u),_=g(),f=q(d),C=g(),this.h()},l(j){t=o(j,"DIV",{class:!0});var E=h(t);s=o(E,"SPAN",{class:!0});var A=h(s);a=T(A,"R"),v=T(A,u),A.forEach(r),_=m(E),f=T(E,d),C=m(E),E.forEach(r),this.h()},h(){c(s,"class","log-round svelte-1l6qcjv"),c(t,"class","log-entry svelte-1l6qcjv")},m(j,E){B(j,t,E),e(t,s),e(s,a),e(s,v),e(t,_),e(t,f),e(t,C)},p(j,E){E[0]&2&&u!==(u=j[46].round+"")&&L(v,u),E[0]&2&&d!==(d=j[46].event+"")&&L(f,d)},d(j){j&&r(t)}}}function qn(l){let t,s,a,u,v,_,d=l[40].GDP.toFixed(0)+"",f,C,j,E=l[40].W+"",A,V,D,I=l[40].POP.toFixed(1)+"",M,w,N,G=l[40].SE+"",U,Q,le,ie=l[40].TE+"",$,qe,ee,Z=l[40].IM+"",Oe,We,F,O=l[40].K.toFixed(1)+"",ye,x,se,Ue=(l[39]===l[0]?l[40].TK:"?")+"",ze,He,he,tt=l[40].BR_total.toFixed(0)+"",Ye,kt,R,y=l[40].BR_effective.toFixed(1)+"",K,_e,W,ae=(l[41]?l[40].TP.L:"?")+"",lt,Qe,ne,Ee=(l[42]?l[40].TP.M:"?")+"",k,te,z,Y=(l[43]?l[40].TP.H:"?")+"",X,be;return{c(){t=i("tr"),s=i("td"),a=i("strong"),u=q(l[39]),v=g(),_=i("td"),f=q(d),C=g(),j=i("td"),A=q(E),V=g(),D=i("td"),M=q(I),w=g(),N=i("td"),U=q(G),Q=g(),le=i("td"),$=q(ie),qe=g(),ee=i("td"),Oe=q(Z),We=g(),F=i("td"),ye=q(O),x=g(),se=i("td"),ze=q(Ue),He=g(),he=i("td"),Ye=q(tt),kt=g(),R=i("td"),K=q(y),_e=g(),W=i("td"),lt=q(ae),Qe=g(),ne=i("td"),k=q(Ee),te=g(),z=i("td"),X=q(Y),be=g(),this.h()},l(S){t=o(S,"TR",{class:!0});var P=h(t);s=o(P,"TD",{class:!0});var ce=h(s);a=o(ce,"STRONG",{});var ml=h(a);u=T(ml,l[39]),ml.forEach(r),ce.forEach(r),v=m(P),_=o(P,"TD",{class:!0});var St=h(_);f=T(St,d),St.forEach(r),C=m(P),j=o(P,"TD",{class:!0});var Ft=h(j);A=T(Ft,E),Ft.forEach(r),V=m(P),D=o(P,"TD",{class:!0});var gl=h(D);M=T(gl,I),gl.forEach(r),w=m(P),N=o(P,"TD",{class:!0});var Lt=h(N);U=T(Lt,G),Lt.forEach(r),Q=m(P),le=o(P,"TD",{class:!0});var Wt=h(le);$=T(Wt,ie),Wt.forEach(r),qe=m(P),ee=o(P,"TD",{class:!0});var Tl=h(ee);Oe=T(Tl,Z),Tl.forEach(r),We=m(P),F=o(P,"TD",{class:!0});var Dt=h(F);ye=T(Dt,O),Dt.forEach(r),x=m(P),se=o(P,"TD",{class:!0});var At=h(se);ze=T(At,Ue),At.forEach(r),He=m(P),he=o(P,"TD",{class:!0});var yt=h(he);Ye=T(yt,tt),yt.forEach(r),kt=m(P),R=o(P,"TD",{class:!0});var Ut=h(R);K=T(Ut,y),Ut.forEach(r),_e=m(P),W=o(P,"TD",{class:!0});var ht=h(W);lt=T(ht,ae),ht.forEach(r),Qe=m(P),ne=o(P,"TD",{class:!0});var Be=h(ne);k=T(Be,Ee),Be.forEach(r),te=m(P),z=o(P,"TD",{class:!0});var nt=h(z);X=T(nt,Y),nt.forEach(r),be=m(P),P.forEach(r),this.h()},h(){c(s,"class","svelte-1l6qcjv"),c(_,"class","svelte-1l6qcjv"),c(j,"class","svelte-1l6qcjv"),c(D,"class","svelte-1l6qcjv"),c(N,"class","svelte-1l6qcjv"),c(le,"class","svelte-1l6qcjv"),c(ee,"class","svelte-1l6qcjv"),c(F,"class","svelte-1l6qcjv"),c(se,"class","svelte-1l6qcjv"),c(he,"class","svelte-1l6qcjv"),c(R,"class","svelte-1l6qcjv"),c(W,"class","svelte-1l6qcjv"),c(ne,"class","svelte-1l6qcjv"),c(z,"class","svelte-1l6qcjv"),c(t,"class","svelte-1l6qcjv"),Sl(t,"current-team",l[39]===l[0])},m(S,P){B(S,t,P),e(t,s),e(s,a),e(a,u),e(t,v),e(t,_),e(_,f),e(t,C),e(t,j),e(j,A),e(t,V),e(t,D),e(D,M),e(t,w),e(t,N),e(N,U),e(t,Q),e(t,le),e(le,$),e(t,qe),e(t,ee),e(ee,Oe),e(t,We),e(t,F),e(F,ye),e(t,x),e(t,se),e(se,ze),e(t,He),e(t,he),e(he,Ye),e(t,kt),e(t,R),e(R,K),e(t,_e),e(t,W),e(W,lt),e(t,Qe),e(t,ne),e(ne,k),e(t,te),e(t,z),e(z,X),e(t,be)},p(S,P){P[0]&2&&d!==(d=S[40].GDP.toFixed(0)+"")&&L(f,d),P[0]&2&&E!==(E=S[40].W+"")&&L(A,E),P[0]&2&&I!==(I=S[40].POP.toFixed(1)+"")&&L(M,I),P[0]&2&&G!==(G=S[40].SE+"")&&L(U,G),P[0]&2&&ie!==(ie=S[40].TE+"")&&L($,ie),P[0]&2&&Z!==(Z=S[40].IM+"")&&L(Oe,Z),P[0]&2&&O!==(O=S[40].K.toFixed(1)+"")&&L(ye,O),P[0]&3&&Ue!==(Ue=(S[39]===S[0]?S[40].TK:"?")+"")&&L(ze,Ue),P[0]&2&&tt!==(tt=S[40].BR_total.toFixed(0)+"")&&L(Ye,tt),P[0]&2&&y!==(y=S[40].BR_effective.toFixed(1)+"")&&L(K,y),P[0]&7&&ae!==(ae=(S[41]?S[40].TP.L:"?")+"")&&L(lt,ae),P[0]&7&&Ee!==(Ee=(S[42]?S[40].TP.M:"?")+"")&&L(k,Ee),P[0]&7&&Y!==(Y=(S[43]?S[40].TP.H:"?")+"")&&L(X,Y),P[0]&1&&Sl(t,"current-team",S[39]===S[0])},d(S){S&&r(t)}}}function Nn(l){let t,s,a,u,v,_,d,f,C,j="Logout",E,A,V;Ea.title=t="Team Interface - "+l[0];function D(w,N){var G;if(w[3])return On;if(!((G=w[1])!=null&&G.game_ready))return An;if(w[2])return Dn}let I=D(l),M=I&&I(l);return{c(){s=g(),a=i("main"),u=i("div"),v=i("h1"),_=q("Team: "),d=q(l[0]),f=g(),C=i("button"),C.textContent=j,E=g(),M&&M.c(),this.h()},l(w){Mn("svelte-nksk0v",Ea.head).forEach(r),s=m(w),a=o(w,"MAIN",{class:!0});var G=h(a);u=o(G,"DIV",{class:!0});var U=h(u);v=o(U,"H1",{class:!0});var Q=h(v);_=T(Q,"Team: "),d=T(Q,l[0]),Q.forEach(r),f=m(U),C=o(U,"BUTTON",{class:!0,"data-svelte-h":!0}),H(C)!=="svelte-1tokop0"&&(C.textContent=j),U.forEach(r),E=m(G),M&&M.l(G),G.forEach(r),this.h()},h(){c(v,"class","svelte-1l6qcjv"),c(C,"class","btn-logout svelte-1l6qcjv"),c(u,"class","header svelte-1l6qcjv"),c(a,"class","container svelte-1l6qcjv")},m(w,N){B(w,s,N),B(w,a,N),e(a,u),e(u,v),e(v,_),e(v,d),e(u,f),e(u,C),e(a,E),M&&M.m(a,null),A||(V=Ae(C,"click",l[18]),A=!0)},p(w,N){N[0]&1&&t!==(t="Team Interface - "+w[0])&&(Ea.title=t),N[0]&1&&L(d,w[0]),I===(I=D(w))&&M?M.p(w,N):(M&&M.d(1),M=I&&I(w),M&&(M.c(),M.m(a,null)))},i:pl,o:pl,d(w){w&&(r(s),r(a)),M&&M.d(),A=!1,V()}}}function wn(l,t,s){let a,u,v,_,d=null,f=null,C=!0,j="",E=!1,A=!1,V="none",D=0,I={L:0,M:0,H:0},M=[{target:"",tech:"L"},{target:"",tech:"L"}],w={used:0,budget:0,remaining:0},N="#d9ffd9",G=!1,U=0,Q;jn(async()=>{const R=sessionStorage.getItem("wargame_role"),y=sessionStorage.getItem("wargame_auth");if(!R||y!=="true"||R==="GM"){en("/");return}s(0,d=R),await ie(),f&&d&&(s(1,f.active_users[d]=!0,f),await $()),f&&(U=f.round),Hl.channel("team-updates").on("postgres_changes",{event:"*",schema:"public",table:"game_state"},K=>{console.log("Real-time update received:",K),K.new&&"data"in K.new&&(s(1,f=K.new.data),console.log("Game state updated from real-time:",f),f.round!==U&&(U=f.round,s(4,j=`Round advanced to ${f.round}`)))}).subscribe(K=>{console.log("Subscription status:",K)}),Q=setInterval(async()=>{document.hidden||await le()},300)}),Cn(()=>{Q&&clearInterval(Q),f&&d&&(s(1,f.active_users[d]=!1,f),$())});async function le(){const{data:R,error:y}=await Hl.from("game_state").select("data").single();if(!y&&R){const K=R.data;JSON.stringify(K)!==JSON.stringify(f)&&(console.log("Polling detected changes, updating state"),K.round!==U&&(U=K.round,s(4,j=`Round advanced to ${K.round}`)),s(1,f=K))}}async function ie(){s(3,C=!0);try{const{data:R,error:y}=await Hl.from("game_state").select("data").limit(1).maybeSingle();y?(console.error("Error loading game state:",y),s(4,j="Error loading game state: "+y.message)):R?s(1,f=R.data):s(4,j="No game state found")}catch(R){console.error("Exception loading game state:",R),s(4,j="Error: "+(R instanceof Error?R.message:String(R)))}s(3,C=!1)}async function $(){var y;if(!f)return;const{error:R}=await Hl.from("game_state").update({data:f,updated_at:new Date().toISOString()}).eq("id",(y=(await Hl.from("game_state").select("id").single()).data)==null?void 0:y.id);R&&console.error("Error saving:",R)}function qe(){if(!d||!f)return;const R=f.teams[d],K=2*R.W,_e=hs.map(X=>f.teams[X].POP),W=_e.reduce((X,be)=>X+be,0)/_e.length,ae=R.POP/W,lt=E?Math.ceil(ae):0,Qe=A?1:0,ne=D,Ee=M.filter(X=>X.target!=="").length,k=I.L+I.M+I.H;let te=0;if(k>0){const X=Math.min(2,k),be=Math.min(2,Math.max(0,k-2)),S=Math.max(0,k-4);te=1*X+2*be+3*S}const z=lt+Qe+ne+te+Ee,Y=K-z;s(11,w={used:z,budget:K,remaining:Y}),Y<0?(s(12,N="#ffcccc"),s(13,G=!1)):Y<=K*.25?(s(12,N="#fff8cc"),s(13,G=!0)):(s(12,N="#d9ffd9"),s(13,G=!0))}async function ee(){if(!d||!f)return;const R=f.teams[d];if(R.submitted){s(4,j="Already submitted for this round");return}const y={L:3,M:2,H:1};for(const k of["L","M","H"])if(I[k]>y[k]){s(4,j=`AR(${k}) limited to ${y[k]} dice per round`);return}for(const k of["L","M","H"])if(R.discovered[k]&&I[k]>0){s(4,j=`You've already discovered ${k} tech`);return}const K=R.BR_effective;if(I.M>0&&K<at.tech_info.M.br_req){s(4,j=`M-level tech requires ${at.tech_info.M.br_req} BR (you have ${K.toFixed(1)})`);return}if(I.H>0&&K<at.tech_info.H.br_req){s(4,j=`H-level tech requires ${at.tech_info.H.br_req} BR (you have ${K.toFixed(1)})`);return}const _e=Sn(R.W,{SE:E?1:0,TE:A?1:0,BR:D,AR:I,SP:M},R.POP,f.teams);if(!_e.ok){s(4,j=`Budget exceeded: ${_e.used}/${_e.budget} dice`);return}const W=[];if(D>0){const k=$a(D),te=k.filter(z=>z>=4).length;W.push({Phase:"BR",Tech:"-",Rolls:k.join(", "),ΔTK:`+${te}`,ΔTP:"—",ΔIM:"—",SP_Result:"—"})}for(const k of["L","M","H"])if(I[k]>0){const te=$a(I[k]),z=at.tech_info[k].ar_thr,Y=te.filter(S=>S>=z).length,be=at.tech_info[k].tp_draw(Y,R.TK).reduce((S,P)=>S+P,0);W.push({Phase:"AR",Tech:k,Rolls:te.join(", "),ΔTK:`+${I[k]}`,ΔTP:`+${be}`,ΔIM:"—",SP_Result:"—"})}V==="open"&&R.IM===0?W.push({Phase:"Policy",Tech:"-",Rolls:"—",ΔTK:"—",ΔTP:"—",ΔIM:"Opened",SP_Result:"—"}):V==="close"&&R.IM===1&&W.push({Phase:"Policy",Tech:"-",Rolls:"—",ΔTK:"—",ΔTP:"—",ΔIM:"Closed",SP_Result:"—"});for(const k of M)if(k.target!==""){const te=f.teams[k.target],z=Math.floor(Math.random()*6)+1;let Y=z;te.IM===1?Y=Math.min(6,z+1):Y=Math.max(1,z-1);const X=k.tech==="L"?1:k.tech==="M"?2:3,be=k.tech==="L"?[2,3]:k.tech==="M"?[3,4]:[4];let S="Failed";Y<=X?S="Caught":be.includes(Y)?S="Failed":Y===5?S="Observe":Y===6&&(S="Observe+Copy"),W.push({Phase:"SP",Tech:k.tech,Rolls:`${z} → ${Y}`,ΔTK:"—",ΔTP:"—",ΔIM:"—",SP_Result:S})}const ae=_e.budget-_e.used,lt=2/3*ae,Qe=R.carry_fraction+lt,ne=Math.floor(Qe),Ee=Qe-ne;W.push({Phase:"Carryover",Tech:"-",Rolls:`${ae} unused`,ΔTK:"—",ΔTP:"—",ΔIM:"—",SP_Result:`+${ne} W next round | remainder ${Ee.toFixed(2)}`}),R.submitted=!0,R.dice_log=W,R.unspent_dice=ae,R.carry_fraction=Ee,R.pending_W_carryover=ne,s(1,f.submissions[d]={SE:E?1:0,TE:A?1:0,IM:V,BR:D,AR:I,SP:M.map(k=>k.target?k:null)},f),await $(),s(4,j="Allocations submitted! Dice rolled.")}function Z(){sessionStorage.clear(),en("/")}const Oe=[[]];function We(){E=this.checked,s(5,E)}function F(){A=this.checked,s(6,A)}function O(){V=this.__value,s(7,V)}function ye(){V=this.__value,s(7,V)}function x(){V=this.__value,s(7,V)}function se(){D=Gt(this.value),s(8,D)}function Ue(){I.L=Gt(this.value),s(9,I)}function ze(){I.M=Gt(this.value),s(9,I)}function He(){I.H=Gt(this.value),s(9,I)}function he(){M[0].target=ds(this),s(10,M),s(16,u),s(0,d)}function tt(){M[0].tech=ds(this),s(10,M),s(16,u),s(0,d)}function Ye(){M[1].target=ds(this),s(10,M),s(16,u),s(0,d)}function kt(){M[1].tech=ds(this),s(10,M),s(16,u),s(0,d)}return l.$$.update=()=>{l.$$.dirty[0]&3&&f&&d&&qe(),l.$$.dirty[0]&3&&d&&f&&qe(),l.$$.dirty[0]&3&&s(2,a=d&&f?f.teams[d]:null),l.$$.dirty[0]&1&&s(16,u=d?hs.filter(R=>R!==d):[]),l.$$.dirty[0]&4&&s(15,v=a&&a.BR_effective>=at.tech_info.M.br_req),l.$$.dirty[0]&4&&s(14,_=a&&a.BR_effective>=at.tech_info.H.br_req)},[d,f,a,C,j,E,A,V,D,I,M,w,N,G,_,v,u,ee,Z,We,F,O,Oe,ye,x,se,Ue,ze,He,he,tt,Ye,kt]}class yn extends Rn{constructor(t){super(),In(this,t,wn,Nn,En,{},null,[-1,-1])}}export{yn as component};
