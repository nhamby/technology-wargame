import{s as us,n as Nt,r as El,o as ds,d as cs,e as wt}from"../chunks/HYagArB5.js";import{S as vs,i as fs,d as r,b as x,c as e,o as Me,p as u,q as _s,h as _,e as n,f as c,r as X,l as h,j as o,s as W,g as k,k as w,v as is,u as hs,w as Ee,x as Ht,n as nl,m as jl}from"../chunks/DFvcoiM4.js";import{s as Lt,c as ms,a as Wl,b as gs,r as Yl,e as et,d as ps,f as ys}from"../chunks/Dfifp6px.js";import{g as Jl}from"../chunks/d6WERGuC.js";import{a as se,G as Ke}from"../chunks/DwIE5O_Y.js";function bs(s,t,l){const i=s.slice();return i[20]=t[l],i}function Ql(s,t,l){const i=s.slice();return i[23]=t[l],i}function Xl(s,t,l){const i=s.slice();i[20]=t[l];const g=i[0].teams[i[20]];i[26]=g;const a=i[26].TP.L+2*i[26].TP.M+3*i[26].TP.H;i[27]=a;const G=1+.2*Math.log1p(i[26].TK);i[28]=G;const v=i[27]*i[28];i[29]=v;const p=2*Math.sqrt(i[26].W);i[30]=p;const T=i[29]+i[30];return i[31]=T,i}function Zl(s,t,l){const i=s.slice();i[20]=t[l];const g=i[0].submissions[i[20]];return i[34]=g,i}function xl(s,t,l){const i=s.slice();return i[20]=t[l],i}function $l(s){let t,l,i='<strong class="svelte-1z10ly9">Debug Info:</strong>',g,a,G,v,p,T,B,y=s[0]?"exists":"null",L,V,S,D,O,j,M=s[0]&&es(s);return{c(){t=o("div"),l=o("p"),l.innerHTML=i,g=h(),a=o("p"),G=w("Loading: "),v=w(s[2]),p=h(),T=o("p"),B=w("GameState: "),L=w(y),V=h(),S=o("p"),D=w("Status: "),O=w(s[3]),j=h(),M&&M.c(),this.h()},l(P){t=n(P,"DIV",{class:!0});var C=c(t);l=n(C,"P",{class:!0,"data-svelte-h":!0}),X(l)!=="svelte-104c1wk"&&(l.innerHTML=i),g=_(C),a=n(C,"P",{class:!0});var H=c(a);G=k(H,"Loading: "),v=k(H,s[2]),H.forEach(r),p=_(C),T=n(C,"P",{class:!0});var U=c(T);B=k(U,"GameState: "),L=k(U,y),U.forEach(r),V=_(C),S=n(C,"P",{class:!0});var b=c(S);D=k(b,"Status: "),O=k(b,s[3]),b.forEach(r),j=_(C),M&&M.l(C),C.forEach(r),this.h()},h(){u(l,"class","svelte-1z10ly9"),u(a,"class","svelte-1z10ly9"),u(T,"class","svelte-1z10ly9"),u(S,"class","svelte-1z10ly9"),u(t,"class","debug-panel svelte-1z10ly9")},m(P,C){x(P,t,C),e(t,l),e(t,g),e(t,a),e(a,G),e(a,v),e(t,p),e(t,T),e(T,B),e(T,L),e(t,V),e(t,S),e(S,D),e(S,O),e(t,j),M&&M.m(t,null)},p(P,C){C[0]&4&&W(v,P[2]),C[0]&1&&y!==(y=P[0]?"exists":"null")&&W(L,y),C[0]&8&&W(O,P[3]),P[0]?M?M.p(P,C):(M=es(P),M.c(),M.m(t,null)):M&&(M.d(1),M=null)},d(P){P&&r(t),M&&M.d()}}}function es(s){let t,l,i=JSON.stringify(Object.keys(s[0].teams||{}))+"",g,a,G,v,p=s[0].game_ready+"",T,B,y,L,V=s[0].round+"",S;return{c(){t=o("p"),l=w("Teams: "),g=w(i),a=h(),G=o("p"),v=w("Game Ready: "),T=w(p),B=h(),y=o("p"),L=w("Round: "),S=w(V),this.h()},l(D){t=n(D,"P",{class:!0});var O=c(t);l=k(O,"Teams: "),g=k(O,i),O.forEach(r),a=_(D),G=n(D,"P",{class:!0});var j=c(G);v=k(j,"Game Ready: "),T=k(j,p),j.forEach(r),B=_(D),y=n(D,"P",{class:!0});var M=c(y);L=k(M,"Round: "),S=k(M,V),M.forEach(r),this.h()},h(){u(t,"class","svelte-1z10ly9"),u(G,"class","svelte-1z10ly9"),u(y,"class","svelte-1z10ly9")},m(D,O){x(D,t,O),e(t,l),e(t,g),x(D,a,O),x(D,G,O),e(G,v),e(G,T),x(D,B,O),x(D,y,O),e(y,L),e(y,S)},p(D,O){O[0]&1&&i!==(i=JSON.stringify(Object.keys(D[0].teams||{}))+"")&&W(g,i),O[0]&1&&p!==(p=D[0].game_ready+"")&&W(T,p),O[0]&1&&V!==(V=D[0].round+"")&&W(S,V)},d(D){D&&(r(t),r(a),r(G),r(B),r(y))}}}function zs(s){let t,l,i,g,a="Main Controls",G,v,p,T,B,y,L,V,S=s[0].game_ready?"Reinitialize Game":"Initialize Game",D,O,j,M="Save Now",P,C,H=s[0].round_resolved?"Round Already Resolved":"Resolve Round",U,b,R,z,E,N,Q,m,I,Y,J="Hard Reset",Z,q,le,ae="Quick Stats",ne,ee,oe,re,we="Current Round",Se,ve,Ie=s[0].round+"",Ge,Ue,ke=Ke.max_rounds+"",Ae,Ne,ye,$,F="Game Status",Te,de,be=s[0].game_ready?"Ready":"Not Started",Pe,fe,Ce,ie,ce,He="Round Status",te,A,tt=s[0].round_resolved?"Resolved":"Pending",ut,dt,zt,Be,qe,Gt="Submissions",Et,Oe,ct,Tt,vt,ft,Le,Fe,At="Submission Status",ol,lt,Ct,Tl='<tr><th class="svelte-1z10ly9">Team</th> <th class="svelte-1z10ly9">Submitted</th> <th class="svelte-1z10ly9">Active</th></tr>',rl,_t,Bt,je,ht,Cl="Team Allocations",il,Rt,st,St,Rl='<tr><th class="svelte-1z10ly9">Team</th> <th class="svelte-1z10ly9">SE</th> <th class="svelte-1z10ly9">TE</th> <th class="svelte-1z10ly9">IM</th> <th class="svelte-1z10ly9">BR</th> <th class="svelte-1z10ly9">AR(L)</th> <th class="svelte-1z10ly9">AR(M)</th> <th class="svelte-1z10ly9">AR(H)</th> <th class="svelte-1z10ly9">SP #1</th> <th class="svelte-1z10ly9">SP #2</th></tr>',ul,mt,Ot,We,gt,Sl="Full Scoreboard",dl,Pt,at,Dt,Pl='<tr><th class="svelte-1z10ly9">Team</th> <th class="svelte-1z10ly9">GDP</th> <th class="svelte-1z10ly9">W</th> <th class="svelte-1z10ly9">POP</th> <th class="svelte-1z10ly9">SE</th> <th class="svelte-1z10ly9">TE</th> <th class="svelte-1z10ly9">IM</th> <th class="svelte-1z10ly9">K</th> <th class="svelte-1z10ly9">TK</th> <th class="svelte-1z10ly9">BR</th> <th class="svelte-1z10ly9">TP(L)</th> <th class="svelte-1z10ly9">TP(M)</th> <th class="svelte-1z10ly9">TP(H)</th> <th class="svelte-1z10ly9">Score</th></tr>',cl,pt,Vt,Ye,yt,Dl="Public Event Log",vl,Je,Kt,Qe,bt,Ml="Admin Tools",fl,nt,ot,Il="Force Unlock All Teams",_l,rt,Ve,Xe,kl="Select Team",hl,Ze,ml,Ut,gl,wl,ze=s[3]&&ts(s),Re=!s[0].game_ready&&ls(),Mt=et(se),_e=[];for(let d=0;d<Mt.length;d+=1)_e[d]=ss(xl(s,Mt,d));let It=et(se),he=[];for(let d=0;d<It.length;d+=1)he[d]=as(Zl(s,It,d));let kt=et(se),me=[];for(let d=0;d<kt.length;d+=1)me[d]=ns(Xl(s,kt,d));let xe=et(s[0].public_log.slice().reverse()),ge=[];for(let d=0;d<xe.length;d+=1)ge[d]=rs(Ql(s,xe,d));let pe=null;xe.length||(pe=os());let Gl=et(se),$e=[];for(let d=0;d<Gl.length;d+=1)$e[d]=Rs(bs(s,Gl,d));return{c(){ze&&ze.c(),t=h(),Re&&Re.c(),l=h(),i=o("div"),g=o("h2"),g.textContent=a,G=h(),v=o("div"),p=o("div"),T=o("label"),B=w(`Current Round:
						`),y=o("input"),L=h(),V=o("button"),D=w(S),O=h(),j=o("button"),j.textContent=M,P=h(),C=o("button"),U=w(H),z=h(),E=o("button"),N=w("Advance Round"),I=h(),Y=o("button"),Y.textContent=J,Z=h(),q=o("div"),le=o("h3"),le.textContent=ae,ne=h(),ee=o("div"),oe=o("div"),re=o("div"),re.textContent=we,Se=h(),ve=o("div"),Ge=w(Ie),Ue=w("/"),Ae=w(ke),Ne=h(),ye=o("div"),$=o("div"),$.textContent=F,Te=h(),de=o("div"),Pe=w(be),Ce=h(),ie=o("div"),ce=o("div"),ce.textContent=He,te=h(),A=o("div"),ut=w(tt),zt=h(),Be=o("div"),qe=o("div"),qe.textContent=Gt,Et=h(),Oe=o("div"),ct=w(s[1]),Tt=w("/4"),ft=h(),Le=o("div"),Fe=o("h3"),Fe.textContent=At,ol=h(),lt=o("table"),Ct=o("thead"),Ct.innerHTML=Tl,rl=h(),_t=o("tbody");for(let d=0;d<_e.length;d+=1)_e[d].c();Bt=h(),je=o("div"),ht=o("h3"),ht.textContent=Cl,il=h(),Rt=o("div"),st=o("table"),St=o("thead"),St.innerHTML=Rl,ul=h(),mt=o("tbody");for(let d=0;d<he.length;d+=1)he[d].c();Ot=h(),We=o("div"),gt=o("h3"),gt.textContent=Sl,dl=h(),Pt=o("div"),at=o("table"),Dt=o("thead"),Dt.innerHTML=Pl,cl=h(),pt=o("tbody");for(let d=0;d<me.length;d+=1)me[d].c();Vt=h(),Ye=o("div"),yt=o("h3"),yt.textContent=Dl,vl=h(),Je=o("div");for(let d=0;d<ge.length;d+=1)ge[d].c();pe&&pe.c(),Kt=h(),Qe=o("div"),bt=o("h3"),bt.textContent=Ml,fl=h(),nt=o("div"),ot=o("button"),ot.textContent=Il,_l=h(),rt=o("div"),Ve=o("select"),Xe=o("option"),Xe.textContent=kl;for(let d=0;d<$e.length;d+=1)$e[d].c();hl=h(),Ze=o("button"),ml=w("Force Mark Submitted"),this.h()},l(d){ze&&ze.l(d),t=_(d),Re&&Re.l(d),l=_(d),i=n(d,"DIV",{class:!0});var K=c(i);g=n(K,"H2",{class:!0,"data-svelte-h":!0}),X(g)!=="svelte-1ervmi1"&&(g.textContent=a),G=_(K),v=n(K,"DIV",{class:!0});var f=c(v);p=n(f,"DIV",{});var De=c(p);T=n(De,"LABEL",{class:!0});var pl=c(T);B=k(pl,`Current Round:
						`),y=n(pl,"INPUT",{type:!0,min:!0,max:!0,class:!0}),pl.forEach(r),De.forEach(r),L=_(f),V=n(f,"BUTTON",{class:!0});var Al=c(V);D=k(Al,S),Al.forEach(r),O=_(f),j=n(f,"BUTTON",{class:!0,"data-svelte-h":!0}),X(j)!=="svelte-1vzsjil"&&(j.textContent=M),P=_(f),C=n(f,"BUTTON",{class:!0,title:!0});var Hl=c(C);U=k(Hl,H),Hl.forEach(r),z=_(f),E=n(f,"BUTTON",{class:!0,title:!0});var Ll=c(E);N=k(Ll,"Advance Round"),Ll.forEach(r),I=_(f),Y=n(f,"BUTTON",{class:!0,"data-svelte-h":!0}),X(Y)!=="svelte-rhcgu5"&&(Y.textContent=J),f.forEach(r),K.forEach(r),Z=_(d),q=n(d,"DIV",{class:!0});var qt=c(q);le=n(qt,"H3",{class:!0,"data-svelte-h":!0}),X(le)!=="svelte-a54s1u"&&(le.textContent=ae),ne=_(qt),ee=n(qt,"DIV",{class:!0});var it=c(ee);oe=n(it,"DIV",{class:!0});var Ft=c(oe);re=n(Ft,"DIV",{class:!0,"data-svelte-h":!0}),X(re)!=="svelte-waq97v"&&(re.textContent=we),Se=_(Ft),ve=n(Ft,"DIV",{class:!0});var jt=c(ve);Ge=k(jt,Ie),Ue=k(jt,"/"),Ae=k(jt,ke),jt.forEach(r),Ft.forEach(r),Ne=_(it),ye=n(it,"DIV",{class:!0});var Wt=c(ye);$=n(Wt,"DIV",{class:!0,"data-svelte-h":!0}),X($)!=="svelte-qri66w"&&($.textContent=F),Te=_(Wt),de=n(Wt,"DIV",{class:!0});var Nl=c(de);Pe=k(Nl,be),Nl.forEach(r),Wt.forEach(r),Ce=_(it),ie=n(it,"DIV",{class:!0});var Yt=c(ie);ce=n(Yt,"DIV",{class:!0,"data-svelte-h":!0}),X(ce)!=="svelte-1098uas"&&(ce.textContent=He),te=_(Yt),A=n(Yt,"DIV",{class:!0});var Bl=c(A);ut=k(Bl,tt),Bl.forEach(r),Yt.forEach(r),zt=_(it),Be=n(it,"DIV",{class:!0});var Jt=c(Be);qe=n(Jt,"DIV",{class:!0,"data-svelte-h":!0}),X(qe)!=="svelte-uqs8r"&&(qe.textContent=Gt),Et=_(Jt),Oe=n(Jt,"DIV",{class:!0});var yl=c(Oe);ct=k(yl,s[1]),Tt=k(yl,"/4"),yl.forEach(r),Jt.forEach(r),it.forEach(r),qt.forEach(r),ft=_(d),Le=n(d,"DIV",{class:!0});var Qt=c(Le);Fe=n(Qt,"H3",{class:!0,"data-svelte-h":!0}),X(Fe)!=="svelte-1d141s4"&&(Fe.textContent=At),ol=_(Qt),lt=n(Qt,"TABLE",{class:!0});var Xt=c(lt);Ct=n(Xt,"THEAD",{"data-svelte-h":!0}),X(Ct)!=="svelte-19qjtyw"&&(Ct.innerHTML=Tl),rl=_(Xt),_t=n(Xt,"TBODY",{class:!0});var Ol=c(_t);for(let ue=0;ue<_e.length;ue+=1)_e[ue].l(Ol);Ol.forEach(r),Xt.forEach(r),Qt.forEach(r),Bt=_(d),je=n(d,"DIV",{class:!0});var Zt=c(je);ht=n(Zt,"H3",{class:!0,"data-svelte-h":!0}),X(ht)!=="svelte-zvjiaq"&&(ht.textContent=Cl),il=_(Zt),Rt=n(Zt,"DIV",{class:!0});var Vl=c(Rt);st=n(Vl,"TABLE",{class:!0});var xt=c(st);St=n(xt,"THEAD",{"data-svelte-h":!0}),X(St)!=="svelte-dcujpi"&&(St.innerHTML=Rl),ul=_(xt),mt=n(xt,"TBODY",{class:!0});var Kl=c(mt);for(let ue=0;ue<he.length;ue+=1)he[ue].l(Kl);Kl.forEach(r),xt.forEach(r),Vl.forEach(r),Zt.forEach(r),Ot=_(d),We=n(d,"DIV",{class:!0});var $t=c(We);gt=n($t,"H3",{class:!0,"data-svelte-h":!0}),X(gt)!=="svelte-yqvbr5"&&(gt.textContent=Sl),dl=_($t),Pt=n($t,"DIV",{class:!0});var Ul=c(Pt);at=n(Ul,"TABLE",{class:!0});var el=c(at);Dt=n(el,"THEAD",{"data-svelte-h":!0}),X(Dt)!=="svelte-ad7173"&&(Dt.innerHTML=Pl),cl=_(el),pt=n(el,"TBODY",{class:!0});var ql=c(pt);for(let ue=0;ue<me.length;ue+=1)me[ue].l(ql);ql.forEach(r),el.forEach(r),Ul.forEach(r),$t.forEach(r),Vt=_(d),Ye=n(d,"DIV",{class:!0});var tl=c(Ye);yt=n(tl,"H3",{class:!0,"data-svelte-h":!0}),X(yt)!=="svelte-1q2cd7v"&&(yt.textContent=Dl),vl=_(tl),Je=n(tl,"DIV",{class:!0});var bl=c(Je);for(let ue=0;ue<ge.length;ue+=1)ge[ue].l(bl);pe&&pe.l(bl),bl.forEach(r),tl.forEach(r),Kt=_(d),Qe=n(d,"DIV",{class:!0});var ll=c(Qe);bt=n(ll,"H3",{class:!0,"data-svelte-h":!0}),X(bt)!=="svelte-krt30i"&&(bt.textContent=Ml),fl=_(ll),nt=n(ll,"DIV",{class:!0});var sl=c(nt);ot=n(sl,"BUTTON",{class:!0,"data-svelte-h":!0}),X(ot)!=="svelte-3fs83r"&&(ot.textContent=Il),_l=_(sl),rt=n(sl,"DIV",{class:!0});var al=c(rt);Ve=n(al,"SELECT",{class:!0});var zl=c(Ve);Xe=n(zl,"OPTION",{"data-svelte-h":!0}),X(Xe)!=="svelte-1pkjahh"&&(Xe.textContent=kl);for(let ue=0;ue<$e.length;ue+=1)$e[ue].l(zl);zl.forEach(r),hl=_(al),Ze=n(al,"BUTTON",{class:!0});var Fl=c(Ze);ml=k(Fl,"Force Mark Submitted"),Fl.forEach(r),al.forEach(r),sl.forEach(r),ll.forEach(r),this.h()},h(){u(g,"class","svelte-1z10ly9"),u(y,"type","number"),u(y,"min","1"),u(y,"max",Ke.max_rounds),u(y,"class","svelte-1z10ly9"),u(T,"class","svelte-1z10ly9"),u(V,"class","btn btn-primary svelte-1z10ly9"),u(j,"class","btn btn-secondary svelte-1z10ly9"),u(C,"class","btn btn-success svelte-1z10ly9"),C.disabled=b=!s[0].game_ready||s[0].round_resolved,u(C,"title",R=s[0].round_resolved?"Round already resolved - advance to next round":"Process team submissions and calculate results"),u(E,"class","btn btn-info svelte-1z10ly9"),E.disabled=Q=!s[0].game_ready||!s[0].round_resolved,u(E,"title",m=s[0].round_resolved?"Move to the next round":"Must resolve current round first"),u(Y,"class","btn btn-danger svelte-1z10ly9"),u(v,"class","control-grid svelte-1z10ly9"),u(i,"class","card svelte-1z10ly9"),u(le,"class","svelte-1z10ly9"),u(re,"class","stat-label svelte-1z10ly9"),u(ve,"class","stat-value svelte-1z10ly9"),u(oe,"class","stat svelte-1z10ly9"),u($,"class","stat-label svelte-1z10ly9"),u(de,"class",fe="stat-value "+(s[0].game_ready?"status-ready":"status-waiting")+" svelte-1z10ly9"),u(ye,"class","stat svelte-1z10ly9"),u(ce,"class","stat-label svelte-1z10ly9"),u(A,"class",dt="stat-value "+(s[0].round_resolved?"status-ready":"status-waiting")+" svelte-1z10ly9"),u(ie,"class","stat svelte-1z10ly9"),u(qe,"class","stat-label svelte-1z10ly9"),u(Oe,"class",vt="stat-value "+(s[6]?"status-ready":"")+" svelte-1z10ly9"),u(Be,"class","stat svelte-1z10ly9"),u(ee,"class","stats-grid svelte-1z10ly9"),u(q,"class","card svelte-1z10ly9"),u(Fe,"class","svelte-1z10ly9"),u(_t,"class","svelte-1z10ly9"),u(lt,"class","svelte-1z10ly9"),u(Le,"class","card svelte-1z10ly9"),u(ht,"class","svelte-1z10ly9"),u(mt,"class","svelte-1z10ly9"),u(st,"class","svelte-1z10ly9"),u(Rt,"class","table-scroll svelte-1z10ly9"),u(je,"class","card svelte-1z10ly9"),u(gt,"class","svelte-1z10ly9"),u(pt,"class","svelte-1z10ly9"),u(at,"class","svelte-1z10ly9"),u(Pt,"class","table-scroll svelte-1z10ly9"),u(We,"class","card svelte-1z10ly9"),u(yt,"class","svelte-1z10ly9"),u(Je,"class","log-container svelte-1z10ly9"),u(Ye,"class","card svelte-1z10ly9"),u(bt,"class","svelte-1z10ly9"),u(ot,"class","btn btn-warning svelte-1z10ly9"),Xe.__value="",nl(Xe,Xe.__value),u(Ve,"class","svelte-1z10ly9"),s[4]===void 0&&cs(()=>s[19].call(Ve)),u(Ze,"class","btn btn-warning svelte-1z10ly9"),Ze.disabled=Ut=!s[4],u(rt,"class","force-submit-group svelte-1z10ly9"),u(nt,"class","admin-tools svelte-1z10ly9"),u(Qe,"class","card svelte-1z10ly9")},m(d,K){ze&&ze.m(d,K),x(d,t,K),Re&&Re.m(d,K),x(d,l,K),x(d,i,K),e(i,g),e(i,G),e(i,v),e(v,p),e(p,T),e(T,B),e(T,y),nl(y,s[0].round),e(v,L),e(v,V),e(V,D),e(v,O),e(v,j),e(v,P),e(v,C),e(C,U),e(v,z),e(v,E),e(E,N),e(v,I),e(v,Y),x(d,Z,K),x(d,q,K),e(q,le),e(q,ne),e(q,ee),e(ee,oe),e(oe,re),e(oe,Se),e(oe,ve),e(ve,Ge),e(ve,Ue),e(ve,Ae),e(ee,Ne),e(ee,ye),e(ye,$),e(ye,Te),e(ye,de),e(de,Pe),e(ee,Ce),e(ee,ie),e(ie,ce),e(ie,te),e(ie,A),e(A,ut),e(ee,zt),e(ee,Be),e(Be,qe),e(Be,Et),e(Be,Oe),e(Oe,ct),e(Oe,Tt),x(d,ft,K),x(d,Le,K),e(Le,Fe),e(Le,ol),e(Le,lt),e(lt,Ct),e(lt,rl),e(lt,_t);for(let f=0;f<_e.length;f+=1)_e[f]&&_e[f].m(_t,null);x(d,Bt,K),x(d,je,K),e(je,ht),e(je,il),e(je,Rt),e(Rt,st),e(st,St),e(st,ul),e(st,mt);for(let f=0;f<he.length;f+=1)he[f]&&he[f].m(mt,null);x(d,Ot,K),x(d,We,K),e(We,gt),e(We,dl),e(We,Pt),e(Pt,at),e(at,Dt),e(at,cl),e(at,pt);for(let f=0;f<me.length;f+=1)me[f]&&me[f].m(pt,null);x(d,Vt,K),x(d,Ye,K),e(Ye,yt),e(Ye,vl),e(Ye,Je);for(let f=0;f<ge.length;f+=1)ge[f]&&ge[f].m(Je,null);pe&&pe.m(Je,null),x(d,Kt,K),x(d,Qe,K),e(Qe,bt),e(Qe,fl),e(Qe,nt),e(nt,ot),e(nt,_l),e(nt,rt),e(rt,Ve),e(Ve,Xe);for(let f=0;f<$e.length;f+=1)$e[f]&&$e[f].m(Ve,null);jl(Ve,s[4],!0),e(rt,hl),e(rt,Ze),e(Ze,ml),gl||(wl=[Me(y,"input",s[18]),Me(V,"click",s[10]),Me(j,"click",s[9]),Me(C,"click",s[11]),Me(E,"click",s[12]),Me(Y,"click",s[13]),Me(ot,"click",s[14]),Me(Ve,"change",s[19]),Me(Ze,"click",s[15])],gl=!0)},p(d,K){if(d[3]?ze?ze.p(d,K):(ze=ts(d),ze.c(),ze.m(t.parentNode,t)):ze&&(ze.d(1),ze=null),d[0].game_ready?Re&&(Re.d(1),Re=null):Re||(Re=ls(),Re.c(),Re.m(l.parentNode,l)),K[0]&1&&is(y.value)!==d[0].round&&nl(y,d[0].round),K[0]&1&&S!==(S=d[0].game_ready?"Reinitialize Game":"Initialize Game")&&W(D,S),K[0]&1&&H!==(H=d[0].round_resolved?"Round Already Resolved":"Resolve Round")&&W(U,H),K[0]&1&&b!==(b=!d[0].game_ready||d[0].round_resolved)&&(C.disabled=b),K[0]&1&&R!==(R=d[0].round_resolved?"Round already resolved - advance to next round":"Process team submissions and calculate results")&&u(C,"title",R),K[0]&1&&Q!==(Q=!d[0].game_ready||!d[0].round_resolved)&&(E.disabled=Q),K[0]&1&&m!==(m=d[0].round_resolved?"Move to the next round":"Must resolve current round first")&&u(E,"title",m),K[0]&1&&Ie!==(Ie=d[0].round+"")&&W(Ge,Ie),K[0]&1&&be!==(be=d[0].game_ready?"Ready":"Not Started")&&W(Pe,be),K[0]&1&&fe!==(fe="stat-value "+(d[0].game_ready?"status-ready":"status-waiting")+" svelte-1z10ly9")&&u(de,"class",fe),K[0]&1&&tt!==(tt=d[0].round_resolved?"Resolved":"Pending")&&W(ut,tt),K[0]&1&&dt!==(dt="stat-value "+(d[0].round_resolved?"status-ready":"status-waiting")+" svelte-1z10ly9")&&u(A,"class",dt),K[0]&2&&W(ct,d[1]),K[0]&64&&vt!==(vt="stat-value "+(d[6]?"status-ready":"")+" svelte-1z10ly9")&&u(Oe,"class",vt),K[0]&1){Mt=et(se);let f;for(f=0;f<Mt.length;f+=1){const De=xl(d,Mt,f);_e[f]?_e[f].p(De,K):(_e[f]=ss(De),_e[f].c(),_e[f].m(_t,null))}for(;f<_e.length;f+=1)_e[f].d(1);_e.length=Mt.length}if(K[0]&1){It=et(se);let f;for(f=0;f<It.length;f+=1){const De=Zl(d,It,f);he[f]?he[f].p(De,K):(he[f]=as(De),he[f].c(),he[f].m(mt,null))}for(;f<he.length;f+=1)he[f].d(1);he.length=It.length}if(K[0]&1){kt=et(se);let f;for(f=0;f<kt.length;f+=1){const De=Xl(d,kt,f);me[f]?me[f].p(De,K):(me[f]=ns(De),me[f].c(),me[f].m(pt,null))}for(;f<me.length;f+=1)me[f].d(1);me.length=kt.length}if(K[0]&1){xe=et(d[0].public_log.slice().reverse());let f;for(f=0;f<xe.length;f+=1){const De=Ql(d,xe,f);ge[f]?ge[f].p(De,K):(ge[f]=rs(De),ge[f].c(),ge[f].m(Je,null))}for(;f<ge.length;f+=1)ge[f].d(1);ge.length=xe.length,!xe.length&&pe?pe.p(d,K):xe.length?pe&&(pe.d(1),pe=null):(pe=os(),pe.c(),pe.m(Je,null))}K[0]&16&&jl(Ve,d[4]),K[0]&16&&Ut!==(Ut=!d[4])&&(Ze.disabled=Ut)},d(d){d&&(r(t),r(l),r(i),r(Z),r(q),r(ft),r(Le),r(Bt),r(je),r(Ot),r(We),r(Vt),r(Ye),r(Kt),r(Qe)),ze&&ze.d(d),Re&&Re.d(d),Ht(_e,d),Ht(he,d),Ht(me,d),Ht(ge,d),pe&&pe.d(),Ht($e,d),gl=!1,El(wl)}}}function Es(s){let t,l,i="Game Not Initialized",g,a,G="The game state exists but teams haven't been set up yet.",v,p,T,B="Current Status:",y,L=s[0].round+"",V,S,D=s[0].game_ready?"Ready":"Not Ready",O,j,M,P,C="Initialize Game & Set Up Teams",H,U,b='<p style="margin: 0 0 0.5rem 0; font-size: 0.9rem;"><strong>What this does:</strong></p> <ul style="margin: 0; font-size: 0.9rem; padding-left: 1.5rem;"><li>Sets up all 4 teams (US, China, France, Russia)</li> <li>Assigns starting GDP, population, and resources</li> <li>Initializes talent pools and technology levels</li> <li>Enables teams to log in and start playing</li></ul>',R,z;return{c(){t=o("div"),l=o("h2"),l.textContent=i,g=h(),a=o("p"),a.textContent=G,v=h(),p=o("p"),T=o("strong"),T.textContent=B,y=w(" Round "),V=w(L),S=w(", "),O=w(D),j=h(),M=o("div"),P=o("button"),P.textContent=C,H=h(),U=o("div"),U.innerHTML=b,this.h()},l(E){t=n(E,"DIV",{class:!0});var N=c(t);l=n(N,"H2",{style:!0,class:!0,"data-svelte-h":!0}),X(l)!=="svelte-1xkmwop"&&(l.textContent=i),g=_(N),a=n(N,"P",{"data-svelte-h":!0}),X(a)!=="svelte-krm0pv"&&(a.textContent=G),v=_(N),p=n(N,"P",{});var Q=c(p);T=n(Q,"STRONG",{"data-svelte-h":!0}),X(T)!=="svelte-mthh15"&&(T.textContent=B),y=k(Q," Round "),V=k(Q,L),S=k(Q,", "),O=k(Q,D),Q.forEach(r),j=_(N),M=n(N,"DIV",{style:!0});var m=c(M);P=n(m,"BUTTON",{class:!0,"data-svelte-h":!0}),X(P)!=="svelte-7c2uog"&&(P.textContent=C),m.forEach(r),H=_(N),U=n(N,"DIV",{style:!0,"data-svelte-h":!0}),X(U)!=="svelte-6pda86"&&(U.innerHTML=b),N.forEach(r),this.h()},h(){Ee(l,"color","orange"),u(l,"class","svelte-1z10ly9"),u(P,"class","btn btn-primary btn-large svelte-1z10ly9"),Ee(M,"margin-top","1.5rem"),Ee(U,"margin-top","1.5rem"),Ee(U,"padding","1rem"),Ee(U,"background","#f0f0f0"),Ee(U,"border-radius","6px"),u(t,"class","card svelte-1z10ly9")},m(E,N){x(E,t,N),e(t,l),e(t,g),e(t,a),e(t,v),e(t,p),e(p,T),e(p,y),e(p,V),e(p,S),e(p,O),e(t,j),e(t,M),e(M,P),e(t,H),e(t,U),R||(z=Me(P,"click",s[10]),R=!0)},p(E,N){N[0]&1&&L!==(L=E[0].round+"")&&W(V,L),N[0]&1&&D!==(D=E[0].game_ready?"Ready":"Not Ready")&&W(O,D)},d(E){E&&r(t),R=!1,z()}}}function Ts(s){let t,l,i="No Game State Found",g,a,G="The database table exists but has no data.",v,p,T,B="Status:",y,L,V,S,D,O="Create Empty Game State",j,M,P="Retry Loading",C,H,U='<p style="margin: 0; font-size: 0.9rem;"><strong>Steps:</strong></p> <ol style="margin: 0.5rem 0; font-size: 0.9rem;"><li>Click &quot;Create Empty Game State&quot; to add initial data</li> <li>Then click &quot;Initialize Game&quot; to set up all teams</li> <li>Teams can then log in and start playing</li></ol>',b,R;return{c(){t=o("div"),l=o("h2"),l.textContent=i,g=h(),a=o("p"),a.textContent=G,v=h(),p=o("p"),T=o("strong"),T.textContent=B,y=h(),L=w(s[3]),V=h(),S=o("div"),D=o("button"),D.textContent=O,j=h(),M=o("button"),M.textContent=P,C=h(),H=o("div"),H.innerHTML=U,this.h()},l(z){t=n(z,"DIV",{class:!0});var E=c(t);l=n(E,"H2",{style:!0,class:!0,"data-svelte-h":!0}),X(l)!=="svelte-16ex8cx"&&(l.textContent=i),g=_(E),a=n(E,"P",{"data-svelte-h":!0}),X(a)!=="svelte-1h4n2e8"&&(a.textContent=G),v=_(E),p=n(E,"P",{});var N=c(p);T=n(N,"STRONG",{"data-svelte-h":!0}),X(T)!=="svelte-1ftu2mm"&&(T.textContent=B),y=_(N),L=k(N,s[3]),N.forEach(r),V=_(E),S=n(E,"DIV",{style:!0});var Q=c(S);D=n(Q,"BUTTON",{class:!0,"data-svelte-h":!0}),X(D)!=="svelte-1eflpqa"&&(D.textContent=O),j=_(Q),M=n(Q,"BUTTON",{class:!0,"data-svelte-h":!0}),X(M)!=="svelte-e6vd6s"&&(M.textContent=P),Q.forEach(r),C=_(E),H=n(E,"DIV",{style:!0,"data-svelte-h":!0}),X(H)!=="svelte-1id5j4z"&&(H.innerHTML=U),E.forEach(r),this.h()},h(){Ee(l,"color","red"),u(l,"class","svelte-1z10ly9"),u(D,"class","btn btn-success svelte-1z10ly9"),u(M,"class","btn btn-secondary svelte-1z10ly9"),Ee(S,"margin-top","1.5rem"),Ee(S,"display","flex"),Ee(S,"gap","1rem"),Ee(H,"margin-top","1.5rem"),Ee(H,"padding","1rem"),Ee(H,"background","#f0f0f0"),Ee(H,"border-radius","6px"),u(t,"class","card svelte-1z10ly9")},m(z,E){x(z,t,E),e(t,l),e(t,g),e(t,a),e(t,v),e(t,p),e(p,T),e(p,y),e(p,L),e(t,V),e(t,S),e(S,D),e(S,j),e(S,M),e(t,C),e(t,H),b||(R=[Me(D,"click",s[8]),Me(M,"click",s[7])],b=!0)},p(z,E){E[0]&8&&W(L,z[3])},d(z){z&&r(t),b=!1,El(R)}}}function Cs(s){let t,l='<h2 class="svelte-1z10ly9">Loading game state...</h2> <p>Please wait...</p>';return{c(){t=o("div"),t.innerHTML=l,this.h()},l(i){t=n(i,"DIV",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-au1jjh"&&(t.innerHTML=l),this.h()},h(){u(t,"class","card svelte-1z10ly9")},m(i,g){x(i,t,g)},p:Nt,d(i){i&&r(t)}}}function ts(s){let t,l;return{c(){t=o("div"),l=w(s[3]),this.h()},l(i){t=n(i,"DIV",{class:!0});var g=c(t);l=k(g,s[3]),g.forEach(r),this.h()},h(){u(t,"class","alert alert-info svelte-1z10ly9")},m(i,g){x(i,t,g),e(t,l)},p(i,g){g[0]&8&&W(l,i[3])},d(i){i&&r(t)}}}function ls(s){let t,l='<h2 style="color: #856404;" class="svelte-1z10ly9">Game Not Initialized</h2> <p>The game state exists but teams haven&#39;t been set up yet.</p> <p><strong>Click &quot;Initialize Game&quot; below to set up all teams with their starting values.</strong></p>';return{c(){t=o("div"),t.innerHTML=l,this.h()},l(i){t=n(i,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),X(t)!=="svelte-1gzbko6"&&(t.innerHTML=l),this.h()},h(){u(t,"class","card svelte-1z10ly9"),Ee(t,"background","#fff3cd"),Ee(t,"border","2px solid #ffc107")},m(i,g){x(i,t,g)},d(i){i&&r(t)}}}function ss(s){var M;let t,l,i,g,a,G,v,p=(M=s[0].teams[s[20]])!=null&&M.submitted?"Yes":"No",T,B,y,L,V,S=s[0].active_users[s[20]]?"Online":"Offline",D,O,j;return{c(){t=o("tr"),l=o("td"),i=o("strong"),g=w(s[20]),a=h(),G=o("td"),v=o("span"),T=w(p),y=h(),L=o("td"),V=o("span"),D=w(S),j=h(),this.h()},l(P){t=n(P,"TR",{class:!0});var C=c(t);l=n(C,"TD",{class:!0});var H=c(l);i=n(H,"STRONG",{});var U=c(i);g=k(U,s[20]),U.forEach(r),H.forEach(r),a=_(C),G=n(C,"TD",{class:!0});var b=c(G);v=n(b,"SPAN",{class:!0});var R=c(v);T=k(R,p),R.forEach(r),b.forEach(r),y=_(C),L=n(C,"TD",{class:!0});var z=c(L);V=n(z,"SPAN",{class:!0});var E=c(V);D=k(E,S),E.forEach(r),z.forEach(r),j=_(C),C.forEach(r),this.h()},h(){var P;u(l,"class","svelte-1z10ly9"),u(v,"class",B="badge "+((P=s[0].teams[s[20]])!=null&&P.submitted?"badge-success":"badge-warning")+" svelte-1z10ly9"),u(G,"class","svelte-1z10ly9"),u(V,"class",O="badge "+(s[0].active_users[s[20]]?"badge-info":"badge-secondary")+" svelte-1z10ly9"),u(L,"class","svelte-1z10ly9"),u(t,"class","svelte-1z10ly9")},m(P,C){x(P,t,C),e(t,l),e(l,i),e(i,g),e(t,a),e(t,G),e(G,v),e(v,T),e(t,y),e(t,L),e(L,V),e(V,D),e(t,j)},p(P,C){var H,U;C[0]&1&&p!==(p=(H=P[0].teams[P[20]])!=null&&H.submitted?"Yes":"No")&&W(T,p),C[0]&1&&B!==(B="badge "+((U=P[0].teams[P[20]])!=null&&U.submitted?"badge-success":"badge-warning")+" svelte-1z10ly9")&&u(v,"class",B),C[0]&1&&S!==(S=P[0].active_users[P[20]]?"Online":"Offline")&&W(D,S),C[0]&1&&O!==(O="badge "+(P[0].active_users[P[20]]?"badge-info":"badge-secondary")+" svelte-1z10ly9")&&u(V,"class",O)},d(P){P&&r(t)}}}function as(s){var Se,ve,Ie,Ge,Ue,ke,Ae,Ne,ye;let t,l,i,g,a,G,v=(((Se=s[34])==null?void 0:Se.SE)??"-")+"",p,T,B,y=(((ve=s[34])==null?void 0:ve.TE)??"-")+"",L,V,S,D=(((Ie=s[34])==null?void 0:Ie.IM)??"-")+"",O,j,M,P=(((Ge=s[34])==null?void 0:Ge.BR)??"-")+"",C,H,U,b=(((Ue=s[34])==null?void 0:Ue.AR.L)??"-")+"",R,z,E,N=(((ke=s[34])==null?void 0:ke.AR.M)??"-")+"",Q,m,I,Y=(((Ae=s[34])==null?void 0:Ae.AR.H)??"-")+"",J,Z,q,le=(Ne=s[34])!=null&&Ne.SP[0]?`${s[34].SP[0].target}/${s[34].SP[0].tech}`:"-",ae,ne,ee,oe=(ye=s[34])!=null&&ye.SP[1]?`${s[34].SP[1].target}/${s[34].SP[1].tech}`:"-",re,we;return{c(){t=o("tr"),l=o("td"),i=o("strong"),g=w(s[20]),a=h(),G=o("td"),p=w(v),T=h(),B=o("td"),L=w(y),V=h(),S=o("td"),O=w(D),j=h(),M=o("td"),C=w(P),H=h(),U=o("td"),R=w(b),z=h(),E=o("td"),Q=w(N),m=h(),I=o("td"),J=w(Y),Z=h(),q=o("td"),ae=w(le),ne=h(),ee=o("td"),re=w(oe),we=h(),this.h()},l($){t=n($,"TR",{class:!0});var F=c(t);l=n(F,"TD",{class:!0});var Te=c(l);i=n(Te,"STRONG",{});var de=c(i);g=k(de,s[20]),de.forEach(r),Te.forEach(r),a=_(F),G=n(F,"TD",{class:!0});var be=c(G);p=k(be,v),be.forEach(r),T=_(F),B=n(F,"TD",{class:!0});var Pe=c(B);L=k(Pe,y),Pe.forEach(r),V=_(F),S=n(F,"TD",{class:!0});var fe=c(S);O=k(fe,D),fe.forEach(r),j=_(F),M=n(F,"TD",{class:!0});var Ce=c(M);C=k(Ce,P),Ce.forEach(r),H=_(F),U=n(F,"TD",{class:!0});var ie=c(U);R=k(ie,b),ie.forEach(r),z=_(F),E=n(F,"TD",{class:!0});var ce=c(E);Q=k(ce,N),ce.forEach(r),m=_(F),I=n(F,"TD",{class:!0});var He=c(I);J=k(He,Y),He.forEach(r),Z=_(F),q=n(F,"TD",{class:!0});var te=c(q);ae=k(te,le),te.forEach(r),ne=_(F),ee=n(F,"TD",{class:!0});var A=c(ee);re=k(A,oe),A.forEach(r),we=_(F),F.forEach(r),this.h()},h(){u(l,"class","svelte-1z10ly9"),u(G,"class","svelte-1z10ly9"),u(B,"class","svelte-1z10ly9"),u(S,"class","svelte-1z10ly9"),u(M,"class","svelte-1z10ly9"),u(U,"class","svelte-1z10ly9"),u(E,"class","svelte-1z10ly9"),u(I,"class","svelte-1z10ly9"),u(q,"class","svelte-1z10ly9"),u(ee,"class","svelte-1z10ly9"),u(t,"class","svelte-1z10ly9")},m($,F){x($,t,F),e(t,l),e(l,i),e(i,g),e(t,a),e(t,G),e(G,p),e(t,T),e(t,B),e(B,L),e(t,V),e(t,S),e(S,O),e(t,j),e(t,M),e(M,C),e(t,H),e(t,U),e(U,R),e(t,z),e(t,E),e(E,Q),e(t,m),e(t,I),e(I,J),e(t,Z),e(t,q),e(q,ae),e(t,ne),e(t,ee),e(ee,re),e(t,we)},p($,F){var Te,de,be,Pe,fe,Ce,ie,ce,He;F[0]&1&&v!==(v=(((Te=$[34])==null?void 0:Te.SE)??"-")+"")&&W(p,v),F[0]&1&&y!==(y=(((de=$[34])==null?void 0:de.TE)??"-")+"")&&W(L,y),F[0]&1&&D!==(D=(((be=$[34])==null?void 0:be.IM)??"-")+"")&&W(O,D),F[0]&1&&P!==(P=(((Pe=$[34])==null?void 0:Pe.BR)??"-")+"")&&W(C,P),F[0]&1&&b!==(b=(((fe=$[34])==null?void 0:fe.AR.L)??"-")+"")&&W(R,b),F[0]&1&&N!==(N=(((Ce=$[34])==null?void 0:Ce.AR.M)??"-")+"")&&W(Q,N),F[0]&1&&Y!==(Y=(((ie=$[34])==null?void 0:ie.AR.H)??"-")+"")&&W(J,Y),F[0]&1&&le!==(le=(ce=$[34])!=null&&ce.SP[0]?`${$[34].SP[0].target}/${$[34].SP[0].tech}`:"-")&&W(ae,le),F[0]&1&&oe!==(oe=(He=$[34])!=null&&He.SP[1]?`${$[34].SP[1].target}/${$[34].SP[1].tech}`:"-")&&W(re,oe)},d($){$&&r(t)}}}function ns(s){let t,l,i,g,a,G,v=s[26].GDP.toFixed(0)+"",p,T,B,y=s[26].W+"",L,V,S,D=s[26].POP.toFixed(1)+"",O,j,M,P=s[26].SE+"",C,H,U,b=s[26].TE+"",R,z,E,N=s[26].IM+"",Q,m,I,Y=s[26].K.toFixed(1)+"",J,Z,q,le=s[26].TK+"",ae,ne,ee,oe=s[26].BR_total+"",re,we,Se,ve=s[26].TP.L+"",Ie,Ge,Ue,ke,Ae=s[26].TP.M+"",Ne,ye,$,F,Te=s[26].TP.H+"",de,be,Pe,fe,Ce,ie=s[31].toFixed(1)+"",ce,He;return{c(){t=o("tr"),l=o("td"),i=o("strong"),g=w(s[20]),a=h(),G=o("td"),p=w(v),T=h(),B=o("td"),L=w(y),V=h(),S=o("td"),O=w(D),j=h(),M=o("td"),C=w(P),H=h(),U=o("td"),R=w(b),z=h(),E=o("td"),Q=w(N),m=h(),I=o("td"),J=w(Y),Z=h(),q=o("td"),ae=w(le),ne=h(),ee=o("td"),re=w(oe),we=h(),Se=o("td"),Ie=w(ve),Ue=h(),ke=o("td"),Ne=w(Ae),$=h(),F=o("td"),de=w(Te),Pe=h(),fe=o("td"),Ce=o("strong"),ce=w(ie),He=h(),this.h()},l(te){t=n(te,"TR",{class:!0});var A=c(t);l=n(A,"TD",{class:!0});var tt=c(l);i=n(tt,"STRONG",{});var ut=c(i);g=k(ut,s[20]),ut.forEach(r),tt.forEach(r),a=_(A),G=n(A,"TD",{class:!0});var dt=c(G);p=k(dt,v),dt.forEach(r),T=_(A),B=n(A,"TD",{class:!0});var zt=c(B);L=k(zt,y),zt.forEach(r),V=_(A),S=n(A,"TD",{class:!0});var Be=c(S);O=k(Be,D),Be.forEach(r),j=_(A),M=n(A,"TD",{class:!0});var qe=c(M);C=k(qe,P),qe.forEach(r),H=_(A),U=n(A,"TD",{class:!0});var Gt=c(U);R=k(Gt,b),Gt.forEach(r),z=_(A),E=n(A,"TD",{class:!0});var Et=c(E);Q=k(Et,N),Et.forEach(r),m=_(A),I=n(A,"TD",{class:!0});var Oe=c(I);J=k(Oe,Y),Oe.forEach(r),Z=_(A),q=n(A,"TD",{class:!0});var ct=c(q);ae=k(ct,le),ct.forEach(r),ne=_(A),ee=n(A,"TD",{class:!0});var Tt=c(ee);re=k(Tt,oe),Tt.forEach(r),we=_(A),Se=n(A,"TD",{class:!0});var vt=c(Se);Ie=k(vt,ve),vt.forEach(r),Ue=_(A),ke=n(A,"TD",{class:!0});var ft=c(ke);Ne=k(ft,Ae),ft.forEach(r),$=_(A),F=n(A,"TD",{class:!0});var Le=c(F);de=k(Le,Te),Le.forEach(r),Pe=_(A),fe=n(A,"TD",{class:!0});var Fe=c(fe);Ce=n(Fe,"STRONG",{});var At=c(Ce);ce=k(At,ie),At.forEach(r),Fe.forEach(r),He=_(A),A.forEach(r),this.h()},h(){u(l,"class","svelte-1z10ly9"),u(G,"class","svelte-1z10ly9"),u(B,"class","svelte-1z10ly9"),u(S,"class","svelte-1z10ly9"),u(M,"class","svelte-1z10ly9"),u(U,"class","svelte-1z10ly9"),u(E,"class","svelte-1z10ly9"),u(I,"class","svelte-1z10ly9"),u(q,"class","svelte-1z10ly9"),u(ee,"class","svelte-1z10ly9"),u(Se,"class",Ge=wt(s[26].discovered.L?"discovered":"")+" svelte-1z10ly9"),u(ke,"class",ye=wt(s[26].discovered.M?"discovered":"")+" svelte-1z10ly9"),u(F,"class",be=wt(s[26].discovered.H?"discovered":"")+" svelte-1z10ly9"),u(fe,"class","svelte-1z10ly9"),u(t,"class","svelte-1z10ly9")},m(te,A){x(te,t,A),e(t,l),e(l,i),e(i,g),e(t,a),e(t,G),e(G,p),e(t,T),e(t,B),e(B,L),e(t,V),e(t,S),e(S,O),e(t,j),e(t,M),e(M,C),e(t,H),e(t,U),e(U,R),e(t,z),e(t,E),e(E,Q),e(t,m),e(t,I),e(I,J),e(t,Z),e(t,q),e(q,ae),e(t,ne),e(t,ee),e(ee,re),e(t,we),e(t,Se),e(Se,Ie),e(t,Ue),e(t,ke),e(ke,Ne),e(t,$),e(t,F),e(F,de),e(t,Pe),e(t,fe),e(fe,Ce),e(Ce,ce),e(t,He)},p(te,A){A[0]&1&&v!==(v=te[26].GDP.toFixed(0)+"")&&W(p,v),A[0]&1&&y!==(y=te[26].W+"")&&W(L,y),A[0]&1&&D!==(D=te[26].POP.toFixed(1)+"")&&W(O,D),A[0]&1&&P!==(P=te[26].SE+"")&&W(C,P),A[0]&1&&b!==(b=te[26].TE+"")&&W(R,b),A[0]&1&&N!==(N=te[26].IM+"")&&W(Q,N),A[0]&1&&Y!==(Y=te[26].K.toFixed(1)+"")&&W(J,Y),A[0]&1&&le!==(le=te[26].TK+"")&&W(ae,le),A[0]&1&&oe!==(oe=te[26].BR_total+"")&&W(re,oe),A[0]&1&&ve!==(ve=te[26].TP.L+"")&&W(Ie,ve),A[0]&1&&Ge!==(Ge=wt(te[26].discovered.L?"discovered":"")+" svelte-1z10ly9")&&u(Se,"class",Ge),A[0]&1&&Ae!==(Ae=te[26].TP.M+"")&&W(Ne,Ae),A[0]&1&&ye!==(ye=wt(te[26].discovered.M?"discovered":"")+" svelte-1z10ly9")&&u(ke,"class",ye),A[0]&1&&Te!==(Te=te[26].TP.H+"")&&W(de,Te),A[0]&1&&be!==(be=wt(te[26].discovered.H?"discovered":"")+" svelte-1z10ly9")&&u(F,"class",be),A[0]&1&&ie!==(ie=te[31].toFixed(1)+"")&&W(ce,ie)},d(te){te&&r(t)}}}function os(s){let t,l="No events yet";return{c(){t=o("p"),t.textContent=l,this.h()},l(i){t=n(i,"P",{class:!0,"data-svelte-h":!0}),X(t)!=="svelte-zeca7u"&&(t.textContent=l),this.h()},h(){u(t,"class","muted svelte-1z10ly9")},m(i,g){x(i,t,g)},p:Nt,d(i){i&&r(t)}}}function rs(s){let t,l,i,g=s[23].round+"",a,G,v=s[23].event+"",p,T;return{c(){t=o("div"),l=o("span"),i=w("R"),a=w(g),G=h(),p=w(v),T=h(),this.h()},l(B){t=n(B,"DIV",{class:!0});var y=c(t);l=n(y,"SPAN",{class:!0});var L=c(l);i=k(L,"R"),a=k(L,g),L.forEach(r),G=_(y),p=k(y,v),T=_(y),y.forEach(r),this.h()},h(){u(l,"class","log-round svelte-1z10ly9"),u(t,"class","log-entry svelte-1z10ly9")},m(B,y){x(B,t,y),e(t,l),e(l,i),e(l,a),e(t,G),e(t,p),e(t,T)},p(B,y){y[0]&1&&g!==(g=B[23].round+"")&&W(a,g),y[0]&1&&v!==(v=B[23].event+"")&&W(p,v)},d(B){B&&r(t)}}}function Rs(s){let t,l;return{c(){t=o("option"),l=w(s[20]),this.h()},l(i){t=n(i,"OPTION",{});var g=c(t);l=k(g,s[20]),g.forEach(r),this.h()},h(){t.__value=s[20],nl(t,t.__value)},m(i,g){x(i,t,g),e(t,l)},p:Nt,d(i){i&&r(t)}}}function Ss(s){let t,l,i,g,a="Game Master Control Panel",G,v,p,T,B,y,L="Debug Mode",V,S,D="Logout",O,j,M,P,C,H=s[5]&&$l(s);function U(z,E){return E[0]&1&&(M=null),z[2]?Cs:z[0]?(M==null&&(M=!!(z[0]&&(!z[0].teams||Array.isArray(z[0].teams)||Object.keys(z[0].teams).length===0))),M?Es:zs):Ts}let b=U(s,[-1,-1]),R=b(s);return{c(){t=h(),l=o("main"),i=o("div"),g=o("h1"),g.textContent=a,G=h(),v=o("div"),p=o("label"),T=o("input"),B=h(),y=o("span"),y.textContent=L,V=h(),S=o("button"),S.textContent=D,O=h(),H&&H.c(),j=h(),R.c(),this.h()},l(z){_s("svelte-1jtlnuh",document.head).forEach(r),t=_(z),l=n(z,"MAIN",{class:!0});var N=c(l);i=n(N,"DIV",{class:!0});var Q=c(i);g=n(Q,"H1",{class:!0,"data-svelte-h":!0}),X(g)!=="svelte-htysh7"&&(g.textContent=a),G=_(Q),v=n(Q,"DIV",{class:!0});var m=c(v);p=n(m,"LABEL",{class:!0});var I=c(p);T=n(I,"INPUT",{type:!0,class:!0}),B=_(I),y=n(I,"SPAN",{"data-svelte-h":!0}),X(y)!=="svelte-kvcfns"&&(y.textContent=L),I.forEach(r),V=_(m),S=n(m,"BUTTON",{class:!0,"data-svelte-h":!0}),X(S)!=="svelte-1tokop0"&&(S.textContent=D),m.forEach(r),Q.forEach(r),O=_(N),H&&H.l(N),j=_(N),R.l(N),N.forEach(r),this.h()},h(){document.title="Game Master Control Panel",u(g,"class","svelte-1z10ly9"),u(T,"type","checkbox"),u(T,"class","svelte-1z10ly9"),u(p,"class","debug-toggle svelte-1z10ly9"),u(S,"class","btn-logout svelte-1z10ly9"),u(v,"class","header-controls svelte-1z10ly9"),u(i,"class","header svelte-1z10ly9"),u(l,"class","container svelte-1z10ly9")},m(z,E){x(z,t,E),x(z,l,E),e(l,i),e(i,g),e(i,G),e(i,v),e(v,p),e(p,T),T.checked=s[5],e(p,B),e(p,y),e(v,V),e(v,S),e(l,O),H&&H.m(l,null),e(l,j),R.m(l,null),P||(C=[Me(T,"change",s[17]),Me(S,"click",s[16])],P=!0)},p(z,E){E[0]&32&&(T.checked=z[5]),z[5]?H?H.p(z,E):(H=$l(z),H.c(),H.m(l,j)):H&&(H.d(1),H=null),b===(b=U(z,E))&&R?R.p(z,E):(R.d(1),R=b(z),R&&(R.c(),R.m(l,null)))},i:Nt,o:Nt,d(z){z&&(r(t),r(l)),H&&H.d(),R.d(),P=!1,El(C)}}}function Ps(s,t,l){let i,g,a=null,G=!0,v="",p="",T=!1;ds(async()=>{const b=sessionStorage.getItem("wargame_role"),R=sessionStorage.getItem("wargame_auth");if(!b||R!=="true"||b!=="GM"){Jl("/");return}await B(),Lt.channel("game-updates").on("postgres_changes",{event:"*",schema:"public",table:"game_state"},z=>{z.new&&"data"in z.new&&l(0,a=z.new.data)}).subscribe()});async function B(){l(2,G=!0);try{const{data:b,error:R}=await Lt.from("game_state").select("*").limit(1).maybeSingle();R?(console.error("Error loading game state:",R),l(3,v="Error loading game state: "+R.message),l(0,a=null)):b?(console.log("Raw data from Supabase:",b),l(0,a=b.data),console.log("Parsed gameState:",a),l(3,v="Game state loaded")):(l(3,v="No data found in database"),l(0,a=null))}catch(b){console.error("Exception loading game state:",b),l(3,v="Error: "+(b instanceof Error?b.message:String(b))),l(0,a=null)}l(2,G=!1)}async function y(){l(2,G=!0),l(3,v="Creating empty game state...");try{const b={round:1,game_ready:!1,round_resolved:!1,teams:{},submissions:{},global_BR_pool:{L:0,M:0,H:0},public_log:[],private_logs:{US:[],China:[],France:[],Russia:[]},active_users:{US:!1,China:!1,France:!1,Russia:!1},history:[]};console.log("Attempting to insert game state...");const{data:R,error:z}=await Lt.from("game_state").insert({data:b}).select().single();z?(console.error("Supabase error creating game state:",z),l(3,v=`Error creating game state: ${z.message} (${z.code})`)):(console.log("Created game state successfully:",R),l(0,a=b),l(3,v='Empty game state created. Click "Initialize Game" to set up teams.'))}catch(b){console.error("Exception creating game state:",b),l(3,v="Error: "+(b instanceof Error?b.message:String(b)))}l(2,G=!1)}async function L(){var R;if(!a)return;const{error:b}=await Lt.from("game_state").update({data:a,updated_at:new Date().toISOString()}).eq("id",(R=(await Lt.from("game_state").select("id").single()).data)==null?void 0:R.id);b?(l(3,v="Error saving game state"),console.error(b)):l(3,v="Game state saved")}async function V(){if(a!=null&&a.game_ready&&!confirm("Game already initialized. Reset and start over?"))return;const b=se.map(N=>Ke.init_by_team[N].GDP),R=se.map(N=>Ke.init_by_team[N].POP),z=ms(b);Wl(R);const E={};se.forEach((N,Q)=>{const m=ps(),I=Ke.init_by_team[N];m.GDP=b[Q],m.POP=R[Q],m.W=z[Q],m.SE=I.SE,m.TE=I.TE,m.IM=I.IM,m.regime=I.regime,m.K=ys(m.SE,m.TE,1),m.TK=0,N==="France"&&(m.TK+=4),N==="Russia"&&(m.TK+=7),E[N]=m}),l(0,a={round:1,teams:E,submissions:{US:null,China:null,France:null,Russia:null},global_BR_pool:{L:0,M:0,H:0},public_log:[],private_logs:{US:[],China:[],France:[],Russia:[]},active_users:{US:!1,China:!1,France:!1,Russia:!1},game_ready:!0,history:[],round_resolved:!1}),await L(),l(3,v="Game initialized! Players can now join.")}async function S(){if(!a)return;if(a.round_resolved){l(3,v="Error: This round has already been resolved. Advance to next round.");return}if(!se.every(m=>a.teams[m].submitted)&&!confirm("Not all teams have submitted. Resolve anyway?"))return;se.forEach(m=>{l(0,a.teams[m].TP_last_round={...a.teams[m].TP},a)});const R=[],z={US:[],China:[],France:[],Russia:[]},E=Wl(se.map(m=>a.teams[m].POP)),N=gs(a.teams);se.forEach((m,I)=>{const Y=a.teams[m],J=a.submissions[m];J&&(J.IM==="open"&&Y.IM===0&&(Y.IM=1),J.IM==="close"&&Y.IM===1&&(Y.IM=0),J.SE>0&&(Y.K+=1*E[I]),J.TE>0&&(Y.K+=1*(1+Y.IM)))}),se.forEach(m=>{const I=a.teams[m];I.K*=N[m]}),se.forEach(m=>{const I=a.teams[m],Y=a.submissions[m];if(!Y||Y.BR===0)return;const J=Yl(Y.BR);let Z=J.filter(le=>le>=4).length;I.regime==="demo"?Z=Math.round(Z*1.1):I.regime==="auto"&&(Z=Math.round(Z*.9));const q=Math.floor(I.K/10);Z+=q,I.BR_total+=Z,I.TK+=Z,R.push(`Round ${a.round}: ${m} - BR successes = ${Z} (rolls: ${J.join(", ")})`)});const Q=se.reduce((m,I)=>m+a.teams[I].BR_total,0);se.forEach(m=>{const I=a.teams[m].BR_total,Y=Q-I;l(0,a.teams[m].BR_effective=I+.75*Y,a)}),R.push(`Round ${a.round}: Global BR - ${se.map(m=>`${m}=${a.teams[m].BR_total}`).join(", ")}`),se.forEach(m=>{const I=a.teams[m],Y=a.submissions[m];Y&&["L","M","H"].forEach(J=>{const Z=Y.AR[J];if(Z===0)return;const q=Ke.tech_info[J];if(I.BR_effective<q.br_req){z[m].push(`Round ${a.round}: AR(${J}) skipped - need ${q.br_req} BR`);return}let ae=Yl(Z).filter(re=>re>=q.ar_thr).length;J!=="L"&&(I.regime==="auto"?ae=Math.round(ae*1.1):I.regime==="demo"&&(ae=Math.round(ae*.9))),I.TK+=Z;let ne=I.TK;J==="M"&&I.K<Ke.min_requirements.M.K_min&&(ne=Math.max(0,ne-10)),J==="H"&&(I.K<Ke.min_requirements.H.K_min||I.TK<Ke.min_requirements.H.TK_min)&&(ne=Math.max(0,ne-10));const oe=q.tp_draw(ae,ne).reduce((re,we)=>re+we,0);ae>0?(I.TP[J]+=oe,z[m].push(`Round ${a.round}: AR(${J}) successes=${ae} → TP +${oe}`)):z[m].push(`Round ${a.round}: AR(${J}) no successes`),I.TP[J]>=Ke.tp_threshold[J]&&!I.discovered[J]&&(I.discovered[J]=!0,z[m].push(`Round ${a.round}: Discovered ${J} tech!`))})}),se.forEach(m=>{const I=a.teams[m],Y=a.submissions[m];!Y||!Y.SP||Y.SP.forEach(J=>{if(!J||!J.target)return;const Z=J.target,q=J.tech,le=a.teams[Z],ae=Math.floor(Math.random()*6)+1;let ne=ae;le.IM===1?ne=Math.min(6,ae+1):ne=Math.max(1,ae-1);const ee=q==="L"?1:q==="M"?2:3,oe=q==="L"?[2,3]:q==="M"?[3,4]:[4];if(ne<=ee)I.spy_caught_count[Z][q]++,R.push(`Round ${a.round}: ${m} spy on ${Z} (${q}) CAUGHT (roll=${ae}→${ne})`);else if(oe.includes(ne))z[m].push(`Round ${a.round}: Spy failed vs ${Z} (${q})`);else if(ne===5)I.spy_revealed[Z][q]=!0,z[m].push(`Round ${a.round}: OBSERVE - Saw ${Z} TP(${q})=${le.TP[q]}`);else if(ne===6){I.spy_revealed[Z][q]=!0;const re=le.TP_last_round[q];I.TP[q]=Math.max(I.TP[q],re),z[m].push(`Round ${a.round}: STEAL SUCCESS - copied TP(${q})=${re} from ${Z}`)}})}),R.forEach(m=>{a.public_log.push({round:a.round,event:m})}),se.forEach(m=>{z[m].forEach(I=>{a.private_logs[m].push({round:a.round,event:I})})}),se.forEach(m=>{l(0,a.teams[m].submitted=!1,a),l(0,a.submissions[m]=null,a)}),l(0,a.round_resolved=!0,a),await L(),l(3,v=`Round ${a.round} resolved! You can now advance to the next round.`)}async function D(){if(a){if(!a.round_resolved){l(3,v="Error: You must resolve the current round before advancing.");return}if(a.round>=Ke.max_rounds){l(3,v="Final round reached!");return}se.forEach(b=>{const R=a.teams[b];R.pending_W_carryover&&(R.W+=R.pending_W_carryover,R.last_carryover=R.pending_W_carryover,R.pending_W_carryover=0)}),l(0,a.round++,a),l(0,a.round_resolved=!1,a),await L(),l(3,v=`Advanced to Round ${a.round}`)}}async function O(){confirm("HARD RESET: Delete all game data and start from Round 1?")&&(await V(),a&&(l(0,a.game_ready=!1,a),l(0,a.round=1,a),l(0,a.round_resolved=!1,a),await L()),l(3,v="Game reset to initial state"))}async function j(){a&&(se.forEach(b=>{l(0,a.active_users[b]=!1,a)}),await L(),l(3,v="All teams unlocked"))}async function M(){!a||!p||(l(0,a.teams[p].submitted=!0,a),await L(),l(3,v=`${p} marked as submitted`),l(4,p=""))}function P(){sessionStorage.clear(),Jl("/")}function C(){T=this.checked,l(5,T)}function H(){a.round=is(this.value),l(0,a)}function U(){p=hs(this),l(4,p)}return s.$$.update=()=>{s.$$.dirty[0]&1&&l(1,i=a?se.filter(b=>{var R;return(R=a.teams[b])==null?void 0:R.submitted}).length:0),s.$$.dirty[0]&2&&l(6,g=i===4)},[a,i,G,v,p,T,g,B,y,L,V,S,D,O,j,M,P,C,H,U]}class Gs extends vs{constructor(t){super(),fs(this,t,Ps,Ss,us,{},null,[-1,-1])}}export{Gs as component};
